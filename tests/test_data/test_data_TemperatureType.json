{
  "function_name": "TemperatureType_module",
  "test_cases": [
    {
      "name": "test_init_temperature_state_nominal_default",
      "function": "init_temperature_state",
      "inputs": {
        "n_columns": 10,
        "n_patches": 25,
        "n_levtot": 20,
        "initial_temp": 273.15
      },
      "expected_shapes": {
        "t_soisno_col": [
          10,
          20
        ],
        "t_a10_patch": [
          25
        ],
        "t_ref2m_patch": [
          25
        ]
      },
      "metadata": {
        "type": "nominal",
        "description": "Standard initialization with default 0\u00b0C temperature, typical domain sizes",
        "edge_cases": []
      }
    },
    {
      "name": "test_init_temperature_state_nominal_warm",
      "function": "init_temperature_state",
      "inputs": {
        "n_columns": 50,
        "n_patches": 100,
        "n_levtot": 20,
        "initial_temp": 298.15
      },
      "expected_shapes": {
        "t_soisno_col": [
          50,
          20
        ],
        "t_a10_patch": [
          100
        ],
        "t_ref2m_patch": [
          100
        ]
      },
      "metadata": {
        "type": "nominal",
        "description": "Warm climate initialization (25\u00b0C), larger domain",
        "edge_cases": []
      }
    },
    {
      "name": "test_init_temperature_state_nominal_cold",
      "function": "init_temperature_state",
      "inputs": {
        "n_columns": 30,
        "n_patches": 60,
        "n_levtot": 20,
        "initial_temp": 253.15
      },
      "expected_shapes": {
        "t_soisno_col": [
          30,
          20
        ],
        "t_a10_patch": [
          60
        ],
        "t_ref2m_patch": [
          60
        ]
      },
      "metadata": {
        "type": "nominal",
        "description": "Cold climate initialization (-20\u00b0C), typical for polar regions",
        "edge_cases": []
      }
    },
    {
      "name": "test_init_allocate_temperature_nominal",
      "function": "init_allocate_temperature",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 49,
          "begc": 0,
          "endc": 19,
          "begg": 0,
          "endg": 9
        },
        "nlevsno": 5,
        "nlevgrnd": 15
      },
      "expected_shapes": {
        "t_soisno_col": [
          20,
          20
        ],
        "t_a10_patch": [
          50
        ],
        "t_ref2m_patch": [
          50
        ]
      },
      "metadata": {
        "type": "nominal",
        "description": "Standard allocation with default layer counts, NaN-filled arrays",
        "edge_cases": []
      }
    },
    {
      "name": "test_init_temperature_nominal",
      "function": "init_temperature",
      "inputs": {
        "bounds": {
          "begp": 0,
          "endp": 99,
          "begc": 0,
          "endc": 39,
          "begg": 0,
          "endg": 19
        },
        "nlevsno": 5,
        "nlevgrnd": 15
      },
      "expected_shapes": {
        "t_soisno_col": [
          40,
          20
        ],
        "t_a10_patch": [
          100
        ],
        "t_ref2m_patch": [
          100
        ]
      },
      "metadata": {
        "type": "nominal",
        "description": "Standard initialization with typical bounds and layer configuration",
        "edge_cases": []
      }
    },
    {
      "name": "test_init_temperature_state_edge_minimum_domain",
      "function": "init_temperature_state",
      "inputs": {
        "n_columns": 1,
        "n_patches": 1,
        "n_levtot": 1,
        "initial_temp": 273.15
      },
      "expected_shapes": {
        "t_soisno_col": [
          1,
          1
        ],
        "t_a10_patch": [
          1
        ],
        "t_ref2m_patch": [
          1
        ]
      },
      "metadata": {
        "type": "edge",
        "description": "Minimum possible domain size (single column, patch, layer)",
        "edge_cases": [
          "minimum_dimensions"
        ]
      }
    },
    {
      "name": "test_init_temperature_state_edge_extreme_cold",
      "function": "init_temperature_state",
      "inputs": {
        "n_columns": 15,
        "n_patches": 30,
        "n_levtot": 20,
        "initial_temp": 173.15
      },
      "expected_shapes": {
        "t_soisno_col": [
          15,
          20
        ],
        "t_a10_patch": [
          30
        ],
        "t_ref2m_patch": [
          30
        ]
      },
      "metadata": {
        "type": "edge",
        "description": "Extreme cold temperature (-100\u00b0C), lower bound of typical range",
        "edge_cases": [
          "extreme_cold"
        ]
      }
    },
    {
      "name": "test_init_temperature_state_edge_extreme_hot",
      "function": "init_temperature_state",
      "inputs": {
        "n_columns": 15,
        "n_patches": 30,
        "n_levtot": 20,
        "initial_temp": 373.15
      },
      "expected_shapes": {
        "t_soisno_col": [
          15,
          20
        ],
        "t_a10_patch": [
          30
        ],
        "t_ref2m_patch": [
          30
        ]
      },
      "metadata": {
        "type": "edge",
        "description": "Extreme hot temperature (100\u00b0C), upper bound of typical range",
        "edge_cases": [
          "extreme_hot"
        ]
      }
    },
    {
      "name": "test_get_soil_snow_temperature_special",
      "function": "get_soil_temperature",
      "inputs": {
        "temp_state": {
          "t_soisno_col": [
            [
              250.0,
              252.0,
              255.0,
              258.0,
              261.0,
              265.0,
              268.0,
              270.0,
              272.0,
              273.0,
              274.0,
              275.0,
              276.0,
              277.0,
              278.0,
              279.0,
              280.0,
              281.0,
              282.0,
              283.0
            ],
            [
              245.0,
              248.0,
              251.0,
              254.0,
              257.0,
              260.0,
              263.0,
              266.0,
              269.0,
              271.0,
              273.0,
              274.5,
              276.0,
              277.5,
              279.0,
              280.5,
              282.0,
              283.5,
              285.0,
              286.5
            ],
            [
              255.0,
              257.0,
              259.0,
              262.0,
              265.0,
              268.0,
              271.0,
              273.5,
              275.0,
              276.0,
              277.0,
              278.0,
              279.0,
              280.0,
              281.0,
              282.0,
              283.0,
              284.0,
              285.0,
              286.0
            ]
          ],
          "t_a10_patch": [
            273.15,
            275.0,
            270.0,
            268.0,
            280.0
          ],
          "t_ref2m_patch": [
            272.0,
            274.5,
            269.5,
            267.0,
            279.0
          ]
        },
        "column_idx": 1,
        "nlevsno": 5
      },
      "expected_output": [
        260.0,
        263.0,
        266.0,
        269.0,
        271.0,
        273.0,
        274.5,
        276.0,
        277.5,
        279.0,
        280.5,
        282.0,
        283.5,
        285.0,
        286.5
      ],
      "metadata": {
        "type": "special",
        "description": "Extract soil temperatures with realistic vertical temperature gradient",
        "edge_cases": []
      }
    },
    {
      "name": "test_update_temperature_special_partial",
      "function": "update_temperature",
      "inputs": {
        "temp_state": {
          "t_soisno_col": [
            [
              273.15,
              273.15,
              273.15,
              273.15,
              273.15
            ],
            [
              273.15,
              273.15,
              273.15,
              273.15,
              273.15
            ]
          ],
          "t_a10_patch": [
            273.15,
            273.15,
            273.15
          ],
          "t_ref2m_patch": [
            273.15,
            273.15,
            273.15
          ]
        },
        "t_soisno_col": null,
        "t_a10_patch": [
          280.0,
          285.0,
          275.0
        ],
        "t_ref2m_patch": null
      },
      "expected_update": {
        "t_a10_patch_updated": true,
        "t_soisno_col_unchanged": true,
        "t_ref2m_patch_unchanged": true
      },
      "metadata": {
        "type": "special",
        "description": "Partial update - only t_a10_patch modified, others remain unchanged",
        "edge_cases": [
          "partial_update"
        ]
      }
    }
  ],
  "additional_test_data": {
    "bounds_variations": [
      {
        "name": "small_domain",
        "bounds": {
          "begp": 0,
          "endp": 9,
          "begc": 0,
          "endc": 4,
          "begg": 0,
          "endg": 1
        },
        "description": "Small domain for quick testing"
      },
      {
        "name": "large_domain",
        "bounds": {
          "begp": 0,
          "endp": 999,
          "begc": 0,
          "endc": 499,
          "begg": 0,
          "endg": 99
        },
        "description": "Large domain for performance testing"
      },
      {
        "name": "offset_indices",
        "bounds": {
          "begp": 100,
          "endp": 149,
          "begc": 50,
          "endc": 74,
          "begg": 20,
          "endg": 29
        },
        "description": "Non-zero starting indices for subdomain testing"
      }
    ],
    "layer_configurations": [
      {
        "name": "no_snow",
        "nlevsno": 0,
        "nlevgrnd": 15,
        "n_levtot": 15,
        "description": "No snow layers, soil only"
      },
      {
        "name": "maximum_snow",
        "nlevsno": 5,
        "nlevgrnd": 15,
        "n_levtot": 20,
        "description": "Maximum snow layers with standard soil"
      },
      {
        "name": "deep_soil",
        "nlevsno": 5,
        "nlevgrnd": 30,
        "n_levtot": 35,
        "description": "Extended soil column for deep permafrost"
      },
      {
        "name": "minimal_layers",
        "nlevsno": 1,
        "nlevgrnd": 1,
        "n_levtot": 2,
        "description": "Minimal layer configuration"
      }
    ],
    "temperature_profiles": [
      {
        "name": "isothermal",
        "description": "Uniform temperature throughout profile",
        "temp": 273.15
      },
      {
        "name": "linear_gradient",
        "description": "Linear increase with depth (cold surface to warm deep)",
        "surface_temp": 263.15,
        "deep_temp": 283.15
      },
      {
        "name": "frozen_ground",
        "description": "Permafrost profile with frozen layers",
        "surface_temp": 253.15,
        "transition_depth": 10,
        "deep_temp": 271.15
      },
      {
        "name": "diurnal_variation",
        "description": "Surface warming with stable deep temperatures",
        "surface_temp": 293.15,
        "deep_temp": 278.15
      }
    ]
  },
  "notes": "Test data generation strategy:\n\n1. **Nominal cases (5 tests)**: Cover standard initialization patterns with typical domain sizes (10-100 columns/patches), default layer configurations (5 snow + 15 soil), and realistic temperature ranges (253-298K representing -20\u00b0C to 25\u00b0C).\n\n2. **Edge cases (3 tests)**: \n   - Minimum domain (1x1x1) to test boundary conditions\n   - Extreme cold (173.15K = -100\u00b0C) at lower bound of typical range\n   - Extreme hot (373.15K = 100\u00b0C) at upper bound of typical range\n\n3. **Special cases (2 tests)**:\n   - Realistic vertical temperature gradient for extraction functions\n   - Partial state updates to test immutability patterns\n\n4. **Physical realism**: All temperatures > 0K (absolute zero), typical ranges based on Earth's climate extremes. Temperature gradients follow realistic geothermal patterns (increasing with depth in cold climates, decreasing in warm climates).\n\n5. **Dimension consistency**: Each test maintains consistent dimensions - n_columns matches endc-begc+1, n_patches matches endp-begp+1, n_levtot = nlevsno + nlevgrnd.\n\n6. **Additional test data**: Provides reusable configurations for bounds variations, layer configurations, and temperature profiles that can be combined for additional test scenarios.\n\n7. **Array indexing**: Column and patch indices are 0-based. Layer indexing follows convention where layers 0 to nlevsno-1 are snow (top to bottom), and nlevsno to n_levtot-1 are soil (top to bottom).\n\n8. **NaN handling**: init_allocate_temperature should return NaN-filled arrays, while init_temperature_state returns arrays filled with initial_temp value."
}