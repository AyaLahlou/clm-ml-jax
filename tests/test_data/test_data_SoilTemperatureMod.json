{
  "function_name": "compute_soil_temperature",
  "test_cases": [
    {
      "name": "test_nominal_single_column_no_snow",
      "inputs": {
        "geom": {
          "dz": [
            [
              0.1,
              0.15,
              0.2,
              0.25,
              0.3,
              0.4,
              0.5,
              0.6,
              0.7,
              0.8
            ]
          ],
          "z": [
            [
              0.05,
              0.175,
              0.35,
              0.575,
              0.85,
              1.25,
              1.75,
              2.35,
              3.05,
              3.85
            ]
          ],
          "zi": [
            [
              0.0,
              0.1,
              0.25,
              0.45,
              0.7,
              1.0,
              1.5,
              2.0,
              2.7,
              3.4,
              4.3
            ]
          ],
          "snl": [
            0
          ],
          "nbedrock": [
            10
          ]
        },
        "t_soisno": [
          [
            283.15,
            283.5,
            284.0,
            284.5,
            285.0,
            285.5,
            286.0,
            286.5,
            287.0,
            287.5
          ]
        ],
        "gsoi": [
          50.0
        ],
        "water": {
          "h2osoi_liq": [
            [
              10.0,
              15.0,
              20.0,
              25.0,
              30.0,
              35.0,
              40.0,
              45.0,
              50.0,
              55.0
            ]
          ],
          "h2osoi_ice": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "h2osfc": [
            0.0
          ],
          "h2osno": [
            0.0
          ],
          "frac_sno_eff": [
            0.0
          ]
        },
        "soil": {
          "tkmg": [
            [
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5
            ]
          ],
          "tkdry": [
            [
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2
            ]
          ],
          "csol": [
            [
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0
            ]
          ],
          "watsat": [
            [
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45
            ]
          ]
        },
        "params": {
          "thin_sfclayer": 1e-06,
          "denh2o": 1000.0,
          "denice": 917.0,
          "tfrz": 273.15,
          "tkwat": 0.57,
          "tkice": 2.29,
          "tkair": 0.023,
          "cpice": 2117.27,
          "cpliq": 4188.0,
          "thk_bedrock": 3.0,
          "csol_bedrock": 2000000.0
        },
        "dtime": 1800.0,
        "nlevsno": 5,
        "nlevgrnd": 10
      },
      "metadata": {
        "type": "nominal",
        "description": "Standard single column case with no snow, moderate temperatures, typical soil moisture",
        "edge_cases": []
      }
    },
    {
      "name": "test_nominal_with_snow_layers",
      "inputs": {
        "geom": {
          "dz": [
            [
              0.05,
              0.08,
              0.12,
              0.1,
              0.15,
              0.2,
              0.25,
              0.3,
              0.4,
              0.5,
              0.6,
              0.7,
              0.8,
              0.9,
              1.0
            ]
          ],
          "z": [
            [
              0.025,
              0.09,
              0.18,
              0.3,
              0.425,
              0.6,
              0.825,
              1.125,
              1.55,
              2.05,
              2.65,
              3.35,
              4.15,
              5.05,
              6.0
            ]
          ],
          "zi": [
            [
              0.0,
              0.05,
              0.13,
              0.25,
              0.35,
              0.5,
              0.7,
              0.95,
              1.25,
              1.65,
              2.15,
              2.75,
              3.45,
              4.25,
              5.15,
              6.15
            ]
          ],
          "snl": [
            -3
          ],
          "nbedrock": [
            15
          ]
        },
        "t_soisno": [
          [
            268.15,
            270.15,
            272.15,
            273.15,
            274.0,
            275.0,
            276.0,
            277.0,
            278.0,
            279.0,
            280.0,
            281.0,
            282.0,
            283.0,
            284.0
          ]
        ],
        "gsoi": [
          25.0
        ],
        "water": {
          "h2osoi_liq": [
            [
              0.0,
              0.0,
              5.0,
              10.0,
              15.0,
              20.0,
              25.0,
              30.0,
              35.0,
              40.0,
              45.0,
              50.0,
              55.0,
              60.0,
              65.0
            ]
          ],
          "h2osoi_ice": [
            [
              8.0,
              12.0,
              15.0,
              5.0,
              2.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "h2osfc": [
            2.5
          ],
          "h2osno": [
            35.0
          ],
          "frac_sno_eff": [
            0.75
          ]
        },
        "soil": {
          "tkmg": [
            [
              2.8,
              2.8,
              2.8,
              2.8,
              2.8,
              2.8,
              2.8,
              2.8,
              2.8,
              2.8
            ]
          ],
          "tkdry": [
            [
              0.25,
              0.25,
              0.25,
              0.25,
              0.25,
              0.25,
              0.25,
              0.25,
              0.25,
              0.25
            ]
          ],
          "csol": [
            [
              2200000.0,
              2200000.0,
              2200000.0,
              2200000.0,
              2200000.0,
              2200000.0,
              2200000.0,
              2200000.0,
              2200000.0,
              2200000.0
            ]
          ],
          "watsat": [
            [
              0.5,
              0.5,
              0.5,
              0.5,
              0.5,
              0.5,
              0.5,
              0.5,
              0.5,
              0.5
            ]
          ]
        },
        "params": {
          "thin_sfclayer": 1e-06,
          "denh2o": 1000.0,
          "denice": 917.0,
          "tfrz": 273.15,
          "tkwat": 0.57,
          "tkice": 2.29,
          "tkair": 0.023,
          "cpice": 2117.27,
          "cpliq": 4188.0,
          "thk_bedrock": 3.0,
          "csol_bedrock": 2000000.0
        },
        "dtime": 900.0,
        "nlevsno": 5,
        "nlevgrnd": 10
      },
      "metadata": {
        "type": "nominal",
        "description": "Winter conditions with 3 snow layers, temperatures near freezing, mixed ice/liquid water",
        "edge_cases": []
      }
    },
    {
      "name": "test_multiple_columns_varying_conditions",
      "inputs": {
        "geom": {
          "dz": [
            [
              0.1,
              0.15,
              0.2,
              0.25,
              0.3,
              0.4,
              0.5,
              0.6,
              0.7,
              0.8
            ],
            [
              0.08,
              0.12,
              0.18,
              0.22,
              0.28,
              0.38,
              0.48,
              0.58,
              0.68,
              0.78
            ],
            [
              0.12,
              0.18,
              0.22,
              0.28,
              0.32,
              0.42,
              0.52,
              0.62,
              0.72,
              0.82
            ]
          ],
          "z": [
            [
              0.05,
              0.175,
              0.35,
              0.575,
              0.85,
              1.25,
              1.75,
              2.35,
              3.05,
              3.85
            ],
            [
              0.04,
              0.14,
              0.29,
              0.51,
              0.79,
              1.17,
              1.65,
              2.23,
              2.91,
              3.69
            ],
            [
              0.06,
              0.21,
              0.4,
              0.64,
              0.96,
              1.38,
              1.9,
              2.52,
              3.24,
              4.06
            ]
          ],
          "zi": [
            [
              0.0,
              0.1,
              0.25,
              0.45,
              0.7,
              1.0,
              1.5,
              2.0,
              2.7,
              3.4,
              4.3
            ],
            [
              0.0,
              0.08,
              0.2,
              0.38,
              0.6,
              0.88,
              1.26,
              1.74,
              2.32,
              3.0,
              3.78
            ],
            [
              0.0,
              0.12,
              0.3,
              0.52,
              0.8,
              1.12,
              1.54,
              2.06,
              2.68,
              3.4,
              4.22
            ]
          ],
          "snl": [
            0,
            -1,
            -2
          ],
          "nbedrock": [
            10,
            9,
            10
          ]
        },
        "t_soisno": [
          [
            290.15,
            289.5,
            289.0,
            288.5,
            288.0,
            287.5,
            287.0,
            286.5,
            286.0,
            285.5
          ],
          [
            265.15,
            273.15,
            275.0,
            276.0,
            277.0,
            278.0,
            279.0,
            280.0,
            281.0,
            282.0
          ],
          [
            258.15,
            260.15,
            273.15,
            274.5,
            276.0,
            277.5,
            279.0,
            280.5,
            282.0,
            283.5
          ]
        ],
        "gsoi": [
          100.0,
          -50.0,
          10.0
        ],
        "water": {
          "h2osoi_liq": [
            [
              25.0,
              30.0,
              35.0,
              40.0,
              45.0,
              50.0,
              55.0,
              60.0,
              65.0,
              70.0
            ],
            [
              0.0,
              5.0,
              10.0,
              15.0,
              20.0,
              25.0,
              30.0,
              35.0,
              40.0,
              45.0
            ],
            [
              0.0,
              0.0,
              8.0,
              12.0,
              18.0,
              24.0,
              30.0,
              36.0,
              42.0,
              48.0
            ]
          ],
          "h2osoi_ice": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              10.0,
              8.0,
              6.0,
              4.0,
              2.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              15.0,
              18.0,
              10.0,
              5.0,
              2.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "h2osfc": [
            0.0,
            1.5,
            3.0
          ],
          "h2osno": [
            0.0,
            15.0,
            45.0
          ],
          "frac_sno_eff": [
            0.0,
            0.4,
            0.9
          ]
        },
        "soil": {
          "tkmg": [
            [
              2.2,
              2.2,
              2.2,
              2.2,
              2.2,
              2.2,
              2.2,
              2.2,
              2.2,
              2.2
            ],
            [
              3.0,
              3.0,
              3.0,
              3.0,
              3.0,
              3.0,
              3.0,
              3.0,
              3.0,
              3.0
            ],
            [
              1.8,
              1.8,
              1.8,
              1.8,
              1.8,
              1.8,
              1.8,
              1.8,
              1.8,
              1.8
            ]
          ],
          "tkdry": [
            [
              0.18,
              0.18,
              0.18,
              0.18,
              0.18,
              0.18,
              0.18,
              0.18,
              0.18,
              0.18
            ],
            [
              0.28,
              0.28,
              0.28,
              0.28,
              0.28,
              0.28,
              0.28,
              0.28,
              0.28,
              0.28
            ],
            [
              0.15,
              0.15,
              0.15,
              0.15,
              0.15,
              0.15,
              0.15,
              0.15,
              0.15,
              0.15
            ]
          ],
          "csol": [
            [
              1800000.0,
              1800000.0,
              1800000.0,
              1800000.0,
              1800000.0,
              1800000.0,
              1800000.0,
              1800000.0,
              1800000.0,
              1800000.0
            ],
            [
              2400000.0,
              2400000.0,
              2400000.0,
              2400000.0,
              2400000.0,
              2400000.0,
              2400000.0,
              2400000.0,
              2400000.0,
              2400000.0
            ],
            [
              1600000.0,
              1600000.0,
              1600000.0,
              1600000.0,
              1600000.0,
              1600000.0,
              1600000.0,
              1600000.0,
              1600000.0,
              1600000.0
            ]
          ],
          "watsat": [
            [
              0.4,
              0.4,
              0.4,
              0.4,
              0.4,
              0.4,
              0.4,
              0.4,
              0.4,
              0.4
            ],
            [
              0.55,
              0.55,
              0.55,
              0.55,
              0.55,
              0.55,
              0.55,
              0.55,
              0.55,
              0.55
            ],
            [
              0.35,
              0.35,
              0.35,
              0.35,
              0.35,
              0.35,
              0.35,
              0.35,
              0.35,
              0.35
            ]
          ]
        },
        "params": {
          "thin_sfclayer": 1e-06,
          "denh2o": 1000.0,
          "denice": 917.0,
          "tfrz": 273.15,
          "tkwat": 0.57,
          "tkice": 2.29,
          "tkair": 0.023,
          "cpice": 2117.27,
          "cpliq": 4188.0,
          "thk_bedrock": 3.0,
          "csol_bedrock": 2000000.0
        },
        "dtime": 1800.0,
        "nlevsno": 5,
        "nlevgrnd": 10
      },
      "metadata": {
        "type": "nominal",
        "description": "Three columns with varying conditions: warm/dry, cold with snow, very cold with deep snow",
        "edge_cases": []
      }
    },
    {
      "name": "test_edge_zero_heat_flux",
      "inputs": {
        "geom": {
          "dz": [
            [
              0.1,
              0.15,
              0.2,
              0.25,
              0.3,
              0.4,
              0.5,
              0.6,
              0.7,
              0.8
            ]
          ],
          "z": [
            [
              0.05,
              0.175,
              0.35,
              0.575,
              0.85,
              1.25,
              1.75,
              2.35,
              3.05,
              3.85
            ]
          ],
          "zi": [
            [
              0.0,
              0.1,
              0.25,
              0.45,
              0.7,
              1.0,
              1.5,
              2.0,
              2.7,
              3.4,
              4.3
            ]
          ],
          "snl": [
            0
          ],
          "nbedrock": [
            10
          ]
        },
        "t_soisno": [
          [
            280.0,
            280.0,
            280.0,
            280.0,
            280.0,
            280.0,
            280.0,
            280.0,
            280.0,
            280.0
          ]
        ],
        "gsoi": [
          0.0
        ],
        "water": {
          "h2osoi_liq": [
            [
              20.0,
              20.0,
              20.0,
              20.0,
              20.0,
              20.0,
              20.0,
              20.0,
              20.0,
              20.0
            ]
          ],
          "h2osoi_ice": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "h2osfc": [
            0.0
          ],
          "h2osno": [
            0.0
          ],
          "frac_sno_eff": [
            0.0
          ]
        },
        "soil": {
          "tkmg": [
            [
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5
            ]
          ],
          "tkdry": [
            [
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2
            ]
          ],
          "csol": [
            [
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0
            ]
          ],
          "watsat": [
            [
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45
            ]
          ]
        },
        "params": {
          "thin_sfclayer": 1e-06,
          "denh2o": 1000.0,
          "denice": 917.0,
          "tfrz": 273.15,
          "tkwat": 0.57,
          "tkice": 2.29,
          "tkair": 0.023,
          "cpice": 2117.27,
          "cpliq": 4188.0,
          "thk_bedrock": 3.0,
          "csol_bedrock": 2000000.0
        },
        "dtime": 1800.0,
        "nlevsno": 5,
        "nlevgrnd": 10
      },
      "metadata": {
        "type": "edge",
        "description": "Zero ground heat flux with uniform temperature profile - tests equilibrium conditions",
        "edge_cases": [
          "zero_flux",
          "uniform_temperature"
        ]
      }
    },
    {
      "name": "test_edge_negative_heat_flux",
      "inputs": {
        "geom": {
          "dz": [
            [
              0.1,
              0.15,
              0.2,
              0.25,
              0.3,
              0.4,
              0.5,
              0.6,
              0.7,
              0.8
            ]
          ],
          "z": [
            [
              0.05,
              0.175,
              0.35,
              0.575,
              0.85,
              1.25,
              1.75,
              2.35,
              3.05,
              3.85
            ]
          ],
          "zi": [
            [
              0.0,
              0.1,
              0.25,
              0.45,
              0.7,
              1.0,
              1.5,
              2.0,
              2.7,
              3.4,
              4.3
            ]
          ],
          "snl": [
            0
          ],
          "nbedrock": [
            10
          ]
        },
        "t_soisno": [
          [
            275.0,
            276.0,
            277.0,
            278.0,
            279.0,
            280.0,
            281.0,
            282.0,
            283.0,
            284.0
          ]
        ],
        "gsoi": [
          -300.0
        ],
        "water": {
          "h2osoi_liq": [
            [
              15.0,
              18.0,
              22.0,
              26.0,
              30.0,
              34.0,
              38.0,
              42.0,
              46.0,
              50.0
            ]
          ],
          "h2osoi_ice": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "h2osfc": [
            0.0
          ],
          "h2osno": [
            0.0
          ],
          "frac_sno_eff": [
            0.0
          ]
        },
        "soil": {
          "tkmg": [
            [
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5
            ]
          ],
          "tkdry": [
            [
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2
            ]
          ],
          "csol": [
            [
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0
            ]
          ],
          "watsat": [
            [
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45
            ]
          ]
        },
        "params": {
          "thin_sfclayer": 1e-06,
          "denh2o": 1000.0,
          "denice": 917.0,
          "tfrz": 273.15,
          "tkwat": 0.57,
          "tkice": 2.29,
          "tkair": 0.023,
          "cpice": 2117.27,
          "cpliq": 4188.0,
          "thk_bedrock": 3.0,
          "csol_bedrock": 2000000.0
        },
        "dtime": 1800.0,
        "nlevsno": 5,
        "nlevgrnd": 10
      },
      "metadata": {
        "type": "edge",
        "description": "Large negative heat flux (upward) - tests cooling from below scenario",
        "edge_cases": [
          "negative_flux",
          "cooling"
        ]
      }
    },
    {
      "name": "test_edge_dry_soil_conditions",
      "inputs": {
        "geom": {
          "dz": [
            [
              0.1,
              0.15,
              0.2,
              0.25,
              0.3,
              0.4,
              0.5,
              0.6,
              0.7,
              0.8
            ]
          ],
          "z": [
            [
              0.05,
              0.175,
              0.35,
              0.575,
              0.85,
              1.25,
              1.75,
              2.35,
              3.05,
              3.85
            ]
          ],
          "zi": [
            [
              0.0,
              0.1,
              0.25,
              0.45,
              0.7,
              1.0,
              1.5,
              2.0,
              2.7,
              3.4,
              4.3
            ]
          ],
          "snl": [
            0
          ],
          "nbedrock": [
            10
          ]
        },
        "t_soisno": [
          [
            310.15,
            308.0,
            306.0,
            304.0,
            302.0,
            300.0,
            298.0,
            296.0,
            294.0,
            292.0
          ]
        ],
        "gsoi": [
          200.0
        ],
        "water": {
          "h2osoi_liq": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "h2osoi_ice": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "h2osfc": [
            0.0
          ],
          "h2osno": [
            0.0
          ],
          "frac_sno_eff": [
            0.0
          ]
        },
        "soil": {
          "tkmg": [
            [
              2.0,
              2.0,
              2.0,
              2.0,
              2.0,
              2.0,
              2.0,
              2.0,
              2.0,
              2.0
            ]
          ],
          "tkdry": [
            [
              0.15,
              0.15,
              0.15,
              0.15,
              0.15,
              0.15,
              0.15,
              0.15,
              0.15,
              0.15
            ]
          ],
          "csol": [
            [
              1500000.0,
              1500000.0,
              1500000.0,
              1500000.0,
              1500000.0,
              1500000.0,
              1500000.0,
              1500000.0,
              1500000.0,
              1500000.0
            ]
          ],
          "watsat": [
            [
              0.35,
              0.35,
              0.35,
              0.35,
              0.35,
              0.35,
              0.35,
              0.35,
              0.35,
              0.35
            ]
          ]
        },
        "params": {
          "thin_sfclayer": 1e-06,
          "denh2o": 1000.0,
          "denice": 917.0,
          "tfrz": 273.15,
          "tkwat": 0.57,
          "tkice": 2.29,
          "tkair": 0.023,
          "cpice": 2117.27,
          "cpliq": 4188.0,
          "thk_bedrock": 3.0,
          "csol_bedrock": 2000000.0
        },
        "dtime": 1800.0,
        "nlevsno": 5,
        "nlevgrnd": 10
      },
      "metadata": {
        "type": "edge",
        "description": "Completely dry soil with high temperatures - tests desert/arid conditions",
        "edge_cases": [
          "zero_water",
          "high_temperature"
        ]
      }
    },
    {
      "name": "test_edge_saturated_soil",
      "inputs": {
        "geom": {
          "dz": [
            [
              0.1,
              0.15,
              0.2,
              0.25,
              0.3,
              0.4,
              0.5,
              0.6,
              0.7,
              0.8
            ]
          ],
          "z": [
            [
              0.05,
              0.175,
              0.35,
              0.575,
              0.85,
              1.25,
              1.75,
              2.35,
              3.05,
              3.85
            ]
          ],
          "zi": [
            [
              0.0,
              0.1,
              0.25,
              0.45,
              0.7,
              1.0,
              1.5,
              2.0,
              2.7,
              3.4,
              4.3
            ]
          ],
          "snl": [
            0
          ],
          "nbedrock": [
            10
          ]
        },
        "t_soisno": [
          [
            278.15,
            278.5,
            279.0,
            279.5,
            280.0,
            280.5,
            281.0,
            281.5,
            282.0,
            282.5
          ]
        ],
        "gsoi": [
          30.0
        ],
        "water": {
          "h2osoi_liq": [
            [
              100.0,
              150.0,
              200.0,
              250.0,
              300.0,
              400.0,
              500.0,
              600.0,
              700.0,
              800.0
            ]
          ],
          "h2osoi_ice": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "h2osfc": [
            10.0
          ],
          "h2osno": [
            0.0
          ],
          "frac_sno_eff": [
            0.0
          ]
        },
        "soil": {
          "tkmg": [
            [
              3.5,
              3.5,
              3.5,
              3.5,
              3.5,
              3.5,
              3.5,
              3.5,
              3.5,
              3.5
            ]
          ],
          "tkdry": [
            [
              0.3,
              0.3,
              0.3,
              0.3,
              0.3,
              0.3,
              0.3,
              0.3,
              0.3,
              0.3
            ]
          ],
          "csol": [
            [
              2500000.0,
              2500000.0,
              2500000.0,
              2500000.0,
              2500000.0,
              2500000.0,
              2500000.0,
              2500000.0,
              2500000.0,
              2500000.0
            ]
          ],
          "watsat": [
            [
              0.6,
              0.6,
              0.6,
              0.6,
              0.6,
              0.6,
              0.6,
              0.6,
              0.6,
              0.6
            ]
          ]
        },
        "params": {
          "thin_sfclayer": 1e-06,
          "denh2o": 1000.0,
          "denice": 917.0,
          "tfrz": 273.15,
          "tkwat": 0.57,
          "tkice": 2.29,
          "tkair": 0.023,
          "cpice": 2117.27,
          "cpliq": 4188.0,
          "thk_bedrock": 3.0,
          "csol_bedrock": 2000000.0
        },
        "dtime": 1800.0,
        "nlevsno": 5,
        "nlevgrnd": 10
      },
      "metadata": {
        "type": "edge",
        "description": "Saturated soil with high water content and surface water - tests wetland/flooded conditions",
        "edge_cases": [
          "saturated",
          "high_water_content"
        ]
      }
    },
    {
      "name": "test_special_freezing_transition",
      "inputs": {
        "geom": {
          "dz": [
            [
              0.1,
              0.15,
              0.2,
              0.25,
              0.3,
              0.4,
              0.5,
              0.6,
              0.7,
              0.8
            ]
          ],
          "z": [
            [
              0.05,
              0.175,
              0.35,
              0.575,
              0.85,
              1.25,
              1.75,
              2.35,
              3.05,
              3.85
            ]
          ],
          "zi": [
            [
              0.0,
              0.1,
              0.25,
              0.45,
              0.7,
              1.0,
              1.5,
              2.0,
              2.7,
              3.4,
              4.3
            ]
          ],
          "snl": [
            0
          ],
          "nbedrock": [
            10
          ]
        },
        "t_soisno": [
          [
            273.15,
            273.15,
            273.15,
            273.15,
            273.15,
            273.15,
            273.15,
            273.15,
            273.15,
            273.15
          ]
        ],
        "gsoi": [
          -100.0
        ],
        "water": {
          "h2osoi_liq": [
            [
              15.0,
              15.0,
              15.0,
              15.0,
              15.0,
              15.0,
              15.0,
              15.0,
              15.0,
              15.0
            ]
          ],
          "h2osoi_ice": [
            [
              15.0,
              15.0,
              15.0,
              15.0,
              15.0,
              15.0,
              15.0,
              15.0,
              15.0,
              15.0
            ]
          ],
          "h2osfc": [
            0.0
          ],
          "h2osno": [
            0.0
          ],
          "frac_sno_eff": [
            0.0
          ]
        },
        "soil": {
          "tkmg": [
            [
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5
            ]
          ],
          "tkdry": [
            [
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2
            ]
          ],
          "csol": [
            [
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0
            ]
          ],
          "watsat": [
            [
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45
            ]
          ]
        },
        "params": {
          "thin_sfclayer": 1e-06,
          "denh2o": 1000.0,
          "denice": 917.0,
          "tfrz": 273.15,
          "tkwat": 0.57,
          "tkice": 2.29,
          "tkair": 0.023,
          "cpice": 2117.27,
          "cpliq": 4188.0,
          "thk_bedrock": 3.0,
          "csol_bedrock": 2000000.0
        },
        "dtime": 1800.0,
        "nlevsno": 5,
        "nlevgrnd": 10
      },
      "metadata": {
        "type": "special",
        "description": "All layers at freezing point with equal ice/liquid water - tests phase transition handling",
        "edge_cases": [
          "freezing_point",
          "phase_transition"
        ]
      }
    },
    {
      "name": "test_special_deep_snow_pack",
      "inputs": {
        "geom": {
          "dz": [
            [
              0.15,
              0.2,
              0.25,
              0.3,
              0.35,
              0.1,
              0.15,
              0.2,
              0.25,
              0.3,
              0.4,
              0.5,
              0.6,
              0.7,
              0.8
            ]
          ],
          "z": [
            [
              0.075,
              0.25,
              0.475,
              0.75,
              1.075,
              1.45,
              1.575,
              1.75,
              1.975,
              2.25,
              2.65,
              3.15,
              3.75,
              4.45,
              5.25
            ]
          ],
          "zi": [
            [
              0.0,
              0.15,
              0.35,
              0.6,
              0.9,
              1.25,
              1.35,
              1.5,
              1.7,
              1.95,
              2.25,
              2.65,
              3.15,
              3.75,
              4.45,
              5.25
            ]
          ],
          "snl": [
            -5
          ],
          "nbedrock": [
            15
          ]
        },
        "t_soisno": [
          [
            253.15,
            258.15,
            263.15,
            268.15,
            271.15,
            273.15,
            274.0,
            275.0,
            276.0,
            277.0,
            278.0,
            279.0,
            280.0,
            281.0,
            282.0
          ]
        ],
        "gsoi": [
          15.0
        ],
        "water": {
          "h2osoi_liq": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              2.0,
              8.0,
              12.0,
              16.0,
              20.0,
              24.0,
              28.0,
              32.0,
              36.0,
              40.0,
              44.0
            ]
          ],
          "h2osoi_ice": [
            [
              25.0,
              30.0,
              35.0,
              40.0,
              38.0,
              10.0,
              5.0,
              2.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "h2osfc": [
            0.0
          ],
          "h2osno": [
            168.0
          ],
          "frac_sno_eff": [
            1.0
          ]
        },
        "soil": {
          "tkmg": [
            [
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5,
              2.5
            ]
          ],
          "tkdry": [
            [
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2,
              0.2
            ]
          ],
          "csol": [
            [
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0,
              2000000.0
            ]
          ],
          "watsat": [
            [
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45,
              0.45
            ]
          ]
        },
        "params": {
          "thin_sfclayer": 1e-06,
          "denh2o": 1000.0,
          "denice": 917.0,
          "tfrz": 273.15,
          "tkwat": 0.57,
          "tkice": 2.29,
          "tkair": 0.023,
          "cpice": 2117.27,
          "cpliq": 4188.0,
          "thk_bedrock": 3.0,
          "csol_bedrock": 2000000.0
        },
        "dtime": 1800.0,
        "nlevsno": 5,
        "nlevgrnd": 10
      },
      "metadata": {
        "type": "special",
        "description": "Maximum snow layers (5) with deep cold snowpack and strong temperature gradient",
        "edge_cases": [
          "max_snow_layers",
          "cold_conditions"
        ]
      }
    },
    {
      "name": "test_special_short_timestep_high_flux",
      "inputs": {
        "geom": {
          "dz": [
            [
              0.1,
              0.15,
              0.2,
              0.25,
              0.3,
              0.4,
              0.5,
              0.6,
              0.7,
              0.8
            ]
          ],
          "z": [
            [
              0.05,
              0.175,
              0.35,
              0.575,
              0.85,
              1.25,
              1.75,
              2.35,
              3.05,
              3.85
            ]
          ],
          "zi": [
            [
              0.0,
              0.1,
              0.25,
              0.45,
              0.7,
              1.0,
              1.5,
              2.0,
              2.7,
              3.4,
              4.3
            ]
          ],
          "snl": [
            0
          ],
          "nbedrock": [
            10
          ]
        },
        "t_soisno": [
          [
            295.15,
            293.0,
            291.0,
            289.0,
            287.0,
            285.0,
            283.0,
            281.0,
            279.0,
            277.0
          ]
        ],
        "gsoi": [
          450.0
        ],
        "water": {
          "h2osoi_liq": [
            [
              18.0,
              22.0,
              26.0,
              30.0,
              34.0,
              38.0,
              42.0,
              46.0,
              50.0,
              54.0
            ]
          ],
          "h2osoi_ice": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "h2osfc": [
            0.5
          ],
          "h2osno": [
            0.0
          ],
          "frac_sno_eff": [
            0.0
          ]
        },
        "soil": {
          "tkmg": [
            [
              2.8,
              2.8,
              2.8,
              2.8,
              2.8,
              2.8,
              2.8,
              2.8,
              2.8,
              2.8
            ]
          ],
          "tkdry": [
            [
              0.22,
              0.22,
              0.22,
              0.22,
              0.22,
              0.22,
              0.22,
              0.22,
              0.22,
              0.22
            ]
          ],
          "csol": [
            [
              2100000.0,
              2100000.0,
              2100000.0,
              2100000.0,
              2100000.0,
              2100000.0,
              2100000.0,
              2100000.0,
              2100000.0,
              2100000.0
            ]
          ],
          "watsat": [
            [
              0.48,
              0.48,
              0.48,
              0.48,
              0.48,
              0.48,
              0.48,
              0.48,
              0.48,
              0.48
            ]
          ]
        },
        "params": {
          "thin_sfclayer": 1e-06,
          "denh2o": 1000.0,
          "denice": 917.0,
          "tfrz": 273.15,
          "tkwat": 0.57,
          "tkice": 2.29,
          "tkair": 0.023,
          "cpice": 2117.27,
          "cpliq": 4188.0,
          "thk_bedrock": 3.0,
          "csol_bedrock": 2000000.0
        },
        "dtime": 60.0,
        "nlevsno": 5,
        "nlevgrnd": 10
      },
      "metadata": {
        "type": "special",
        "description": "Short timestep (60s) with high heat flux - tests numerical stability at fine temporal resolution",
        "edge_cases": [
          "short_timestep",
          "high_flux"
        ]
      }
    }
  ],
  "notes": "Test data generation strategy:\n\n1. **Nominal cases (tests 1-3)**: Cover typical operational scenarios including no snow, winter with snow layers, and multiple columns with varying conditions. Temperatures range from 258K to 323K, representing realistic Earth surface conditions.\n\n2. **Edge cases (tests 4-7)**: \n   - Zero heat flux with uniform temperature (equilibrium)\n   - Large negative flux (cooling from below)\n   - Completely dry soil with high temperatures (desert)\n   - Saturated soil with surface water (wetland)\n\n3. **Special cases (tests 8-10)**:\n   - Freezing point transition with mixed phase water\n   - Maximum snow layers with deep cold snowpack\n   - Short timestep with high flux for numerical stability testing\n\n**Physical constraints enforced**:\n- All temperatures > 0K (Kelvin scale)\n- Layer thicknesses (dz) > 0\n- Depths (z, zi) >= 0 and monotonically increasing\n- Snow layer count (snl) <= 0\n- Water contents >= 0\n- Snow fraction in [0, 1]\n- Soil saturation (watsat) in [0, 1]\n- Thermal conductivities > 0\n- Heat capacities > 0\n- Timestep > 0\n\n**Array dimensions**:\n- n_levtot = nlevsno + nlevgrnd (total layers including snow)\n- Soil properties only for nlevgrnd layers\n- Water/temperature for all n_levtot layers\n- Interface depths (zi) have n_levtot + 1 elements\n\n**Test coverage**:\n- Single and multiple columns\n- Various snow conditions (0 to 5 layers)\n- Temperature ranges: 253K to 310K\n- Heat flux ranges: -300 to 450 W/m\u00b2\n- Timesteps: 60s to 1800s\n- Dry to saturated soil conditions\n- Phase transitions and mixed ice/liquid states"
}