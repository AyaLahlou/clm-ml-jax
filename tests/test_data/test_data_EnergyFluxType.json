{
  "function_name": "EnergyFluxType_module",
  "test_cases": [
    {
      "name": "test_init_allocate_small_domain",
      "function": "init_allocate",
      "inputs": {
        "bounds": {
          "begp": 1,
          "endp": 5,
          "begc": 1,
          "endc": 3,
          "begg": 1,
          "endg": 2
        }
      },
      "expected_output": {
        "n_patches": 5,
        "all_fields_nan": true,
        "dtype": "float32"
      },
      "metadata": {
        "type": "nominal",
        "description": "Small domain with 5 patches, typical initialization",
        "edge_cases": []
      }
    },
    {
      "name": "test_init_allocate_single_patch",
      "function": "init_allocate",
      "inputs": {
        "bounds": {
          "begp": 1,
          "endp": 1,
          "begc": 1,
          "endc": 1,
          "begg": 1,
          "endg": 1
        }
      },
      "expected_output": {
        "n_patches": 1,
        "all_fields_nan": true,
        "dtype": "float32"
      },
      "metadata": {
        "type": "edge",
        "description": "Minimum domain size with single patch",
        "edge_cases": [
          "minimum_size"
        ]
      }
    },
    {
      "name": "test_init_allocate_large_domain",
      "function": "init_allocate",
      "inputs": {
        "bounds": {
          "begp": 1,
          "endp": 1000,
          "begc": 1,
          "endc": 500,
          "begg": 1,
          "endg": 100
        }
      },
      "expected_output": {
        "n_patches": 1000,
        "all_fields_nan": true,
        "dtype": "float32"
      },
      "metadata": {
        "type": "special",
        "description": "Large domain with 1000 patches for scalability testing",
        "edge_cases": [
          "large_scale"
        ]
      }
    },
    {
      "name": "test_init_energyflux_type_typical",
      "function": "init_energyflux_type",
      "inputs": {
        "n_patches": 50
      },
      "expected_output": {
        "n_patches": 50,
        "all_fields_zero": true,
        "dtype": "float64",
        "field_shapes": {
          "eflx_sh_tot_patch": [
            50
          ],
          "eflx_lh_tot_patch": [
            50
          ],
          "eflx_lwrad_out_patch": [
            50
          ],
          "taux_patch": [
            50
          ],
          "tauy_patch": [
            50
          ]
        }
      },
      "metadata": {
        "type": "nominal",
        "description": "Typical domain with 50 patches, zero initialization",
        "edge_cases": []
      }
    },
    {
      "name": "test_update_energy_flux_sensible_heat",
      "function": "update_energy_flux",
      "inputs": {
        "eflux": {
          "eflx_sh_tot_patch": [
            0.0,
            0.0,
            0.0
          ],
          "eflx_lh_tot_patch": [
            0.0,
            0.0,
            0.0
          ],
          "eflx_lwrad_out_patch": [
            300.0,
            300.0,
            300.0
          ],
          "taux_patch": [
            0.0,
            0.0,
            0.0
          ],
          "tauy_patch": [
            0.0,
            0.0,
            0.0
          ]
        },
        "kwargs": {
          "eflx_sh_tot_patch": [
            150.5,
            -50.2,
            450.8
          ]
        }
      },
      "expected_output": {
        "eflx_sh_tot_patch": [
          150.5,
          -50.2,
          450.8
        ],
        "eflx_lh_tot_patch": [
          0.0,
          0.0,
          0.0
        ],
        "eflx_lwrad_out_patch": [
          300.0,
          300.0,
          300.0
        ],
        "taux_patch": [
          0.0,
          0.0,
          0.0
        ],
        "tauy_patch": [
          0.0,
          0.0,
          0.0
        ]
      },
      "metadata": {
        "type": "nominal",
        "description": "Update sensible heat flux with typical daytime values including negative (cooling)",
        "edge_cases": []
      }
    },
    {
      "name": "test_update_energy_flux_multiple_fields",
      "function": "update_energy_flux",
      "inputs": {
        "eflux": {
          "eflx_sh_tot_patch": [
            100.0,
            200.0
          ],
          "eflx_lh_tot_patch": [
            50.0,
            75.0
          ],
          "eflx_lwrad_out_patch": [
            400.0,
            420.0
          ],
          "taux_patch": [
            0.5,
            -0.3
          ],
          "tauy_patch": [
            0.2,
            0.1
          ]
        },
        "kwargs": {
          "eflx_sh_tot_patch": [
            250.0,
            300.0
          ],
          "eflx_lh_tot_patch": [
            150.0,
            200.0
          ],
          "taux_patch": [
            1.5,
            -1.2
          ]
        }
      },
      "expected_output": {
        "eflx_sh_tot_patch": [
          250.0,
          300.0
        ],
        "eflx_lh_tot_patch": [
          150.0,
          200.0
        ],
        "eflx_lwrad_out_patch": [
          400.0,
          420.0
        ],
        "taux_patch": [
          1.5,
          -1.2
        ],
        "tauy_patch": [
          0.2,
          0.1
        ]
      },
      "metadata": {
        "type": "nominal",
        "description": "Update multiple fields simultaneously with realistic values",
        "edge_cases": []
      }
    },
    {
      "name": "test_validate_energy_flux_valid_typical",
      "function": "validate_energy_flux",
      "inputs": {
        "eflux": {
          "eflx_sh_tot_patch": [
            120.5,
            85.3,
            200.0,
            -150.0
          ],
          "eflx_lh_tot_patch": [
            300.0,
            450.0,
            100.0,
            0.0
          ],
          "eflx_lwrad_out_patch": [
            380.0,
            420.0,
            350.0,
            500.0
          ],
          "taux_patch": [
            0.8,
            -0.5,
            2.3,
            0.0
          ],
          "tauy_patch": [
            1.2,
            0.3,
            -1.8,
            0.0
          ]
        }
      },
      "expected_output": true,
      "metadata": {
        "type": "nominal",
        "description": "All values within valid physical ranges for typical conditions",
        "edge_cases": []
      }
    },
    {
      "name": "test_validate_energy_flux_boundary_values",
      "function": "validate_energy_flux",
      "inputs": {
        "eflux": {
          "eflx_sh_tot_patch": [
            -500.0,
            1000.0,
            0.0
          ],
          "eflx_lh_tot_patch": [
            -100.0,
            1000.0,
            500.0
          ],
          "eflx_lwrad_out_patch": [
            100.0,
            700.0,
            400.0
          ],
          "taux_patch": [
            -10.0,
            10.0,
            0.0
          ],
          "tauy_patch": [
            -10.0,
            10.0,
            5.0
          ]
        }
      },
      "expected_output": true,
      "metadata": {
        "type": "edge",
        "description": "Test exact boundary values for all constraints",
        "edge_cases": [
          "boundary_min",
          "boundary_max",
          "zero_flux"
        ]
      }
    },
    {
      "name": "test_validate_energy_flux_invalid_out_of_bounds",
      "function": "validate_energy_flux",
      "inputs": {
        "eflux": {
          "eflx_sh_tot_patch": [
            150.0,
            1200.0,
            200.0
          ],
          "eflx_lh_tot_patch": [
            300.0,
            450.0,
            100.0
          ],
          "eflx_lwrad_out_patch": [
            380.0,
            420.0,
            350.0
          ],
          "taux_patch": [
            0.8,
            -0.5,
            2.3
          ],
          "tauy_patch": [
            1.2,
            0.3,
            -1.8
          ]
        }
      },
      "expected_output": false,
      "metadata": {
        "type": "edge",
        "description": "Sensible heat flux exceeds maximum bound (1200 > 1000)",
        "edge_cases": [
          "out_of_bounds"
        ]
      }
    },
    {
      "name": "test_validate_energy_flux_extreme_conditions",
      "function": "validate_energy_flux",
      "inputs": {
        "eflux": {
          "eflx_sh_tot_patch": [
            -450.0,
            950.0,
            -200.0,
            800.0,
            0.0
          ],
          "eflx_lh_tot_patch": [
            950.0,
            5.0,
            800.0,
            0.0,
            -50.0
          ],
          "eflx_lwrad_out_patch": [
            150.0,
            680.0,
            200.0,
            600.0,
            400.0
          ],
          "taux_patch": [
            -9.5,
            9.8,
            -5.0,
            5.0,
            0.0
          ],
          "tauy_patch": [
            9.2,
            -9.7,
            4.5,
            -4.5,
            0.0
          ]
        }
      },
      "expected_output": true,
      "metadata": {
        "type": "special",
        "description": "Extreme but valid conditions: strong cooling/heating, high winds, polar night/desert day",
        "edge_cases": [
          "extreme_valid"
        ]
      }
    }
  ],
  "notes": "Test data generation assumptions:\n\n1. **Fortran 1-based indexing**: All bounds use begp/endp >= 1, with endp >= begp to ensure valid ranges.\n\n2. **Physical realism**:\n   - Sensible heat: [-500, 1000] W/m\u00b2 covers strong nocturnal cooling to intense daytime heating\n   - Latent heat: [-100, 1000] W/m\u00b2 includes dew formation (negative) to strong evapotranspiration\n   - Longwave radiation: [100, 700] W/m\u00b2 spans cold polar surfaces to hot desert surfaces (Stefan-Boltzmann)\n   - Wind stress: [-10, 10] kg/m/s\u00b2 covers calm to hurricane-force winds\n\n3. **Sign convention**: All fluxes positive upward (surface to atmosphere), consistent with atmospheric modeling conventions.\n\n4. **Initialization patterns**:\n   - init_allocate: Returns NaN (float32) for uninitialized state detection\n   - init_energyflux_type: Returns zeros (float64) for accumulator initialization\n\n5. **Test coverage**:\n   - Nominal (50%): Tests 1, 4, 5, 6, 7 - typical operational conditions\n   - Edge (30%): Tests 2, 8, 9 - boundaries, minimum sizes, invalid data\n   - Special (20%): Tests 3, 10 - large scale, extreme valid conditions\n\n6. **Array dimensions**: All fields within a test case have consistent n_patches dimension.\n\n7. **Validation logic**: Checks for NaN values and physical constraint violations per field specifications.\n\n8. **Update semantics**: update_energy_flux creates new instance with specified fields replaced, others preserved (functional/immutable pattern)."
}