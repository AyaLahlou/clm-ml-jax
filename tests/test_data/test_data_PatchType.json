{
  "function_name": "PatchType",
  "test_cases": [
    {
      "name": "test_single_patch_basic_tree",
      "inputs": {
        "begp": 0,
        "endp": 0,
        "max_patches": 10,
        "column": [
          0,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999
        ],
        "gridcell": [
          0,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999
        ],
        "itype": [
          1,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999
        ]
      },
      "metadata": {
        "type": "nominal",
        "description": "Single patch with needleleaf evergreen temperate tree (PFT 1)",
        "edge_cases": [],
        "expected_properties": {
          "is_vegetated": true,
          "is_tree": true,
          "is_crop": false,
          "photosynthesis_type": "C3",
          "phenology_type": "EVERGREEN"
        }
      }
    },
    {
      "name": "test_multiple_patches_mixed_vegetation",
      "inputs": {
        "begp": 0,
        "endp": 4,
        "max_patches": 10,
        "column": [
          0,
          0,
          1,
          1,
          2,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999
        ],
        "gridcell": [
          0,
          0,
          0,
          0,
          1,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999
        ],
        "itype": [
          1,
          4,
          12,
          14,
          15,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999
        ]
      },
      "metadata": {
        "type": "nominal",
        "description": "Five patches with mixed vegetation: needleleaf tree, broadleaf tropical tree, C3 arctic grass, C4 grass, C3 crop",
        "edge_cases": [],
        "expected_properties": {
          "num_patches": 5,
          "num_vegetated": 5,
          "num_trees": 2,
          "num_crops": 1,
          "num_c3": 3,
          "num_c4": 1
        }
      }
    },
    {
      "name": "test_not_vegetated_patch",
      "inputs": {
        "begp": 0,
        "endp": 2,
        "max_patches": 5,
        "column": [
          0,
          1,
          2,
          -9999,
          -9999
        ],
        "gridcell": [
          0,
          0,
          0,
          -9999,
          -9999
        ],
        "itype": [
          0,
          0,
          0,
          -9999,
          -9999
        ]
      },
      "metadata": {
        "type": "edge",
        "description": "All patches are not vegetated (PFT 0) - bare ground/water/ice",
        "edge_cases": [
          "not_vegetated"
        ],
        "expected_properties": {
          "is_vegetated": false,
          "is_tree": false,
          "is_crop": false,
          "num_vegetated": 0
        }
      }
    },
    {
      "name": "test_maximum_pft_code",
      "inputs": {
        "begp": 0,
        "endp": 2,
        "max_patches": 5,
        "column": [
          0,
          1,
          2,
          -9999,
          -9999
        ],
        "gridcell": [
          0,
          0,
          0,
          -9999,
          -9999
        ],
        "itype": [
          76,
          77,
          78,
          -9999,
          -9999
        ]
      },
      "metadata": {
        "type": "edge",
        "description": "Patches with maximum valid PFT codes (76-78) - testing upper boundary",
        "edge_cases": [
          "max_pft_code"
        ],
        "expected_properties": {
          "is_vegetated": true,
          "max_pft_code": 78
        }
      }
    },
    {
      "name": "test_single_patch_zero_index",
      "inputs": {
        "begp": 0,
        "endp": 0,
        "max_patches": 1,
        "column": [
          0
        ],
        "gridcell": [
          0
        ],
        "itype": [
          13
        ]
      },
      "metadata": {
        "type": "edge",
        "description": "Minimal configuration: single patch at index 0 with C3 non-arctic grass",
        "edge_cases": [
          "zero_index",
          "minimal_size"
        ],
        "expected_properties": {
          "num_patches": 1,
          "is_grass": true,
          "is_c3_plant": true
        }
      }
    },
    {
      "name": "test_large_patch_array",
      "inputs": {
        "begp": 0,
        "endp": 99,
        "max_patches": 100,
        "column": [
          0,
          0,
          0,
          0,
          0,
          1,
          1,
          1,
          1,
          1,
          2,
          2,
          2,
          2,
          2,
          3,
          3,
          3,
          3,
          3,
          4,
          4,
          4,
          4,
          4,
          5,
          5,
          5,
          5,
          5,
          6,
          6,
          6,
          6,
          6,
          7,
          7,
          7,
          7,
          7,
          8,
          8,
          8,
          8,
          8,
          9,
          9,
          9,
          9,
          9,
          10,
          10,
          10,
          10,
          10,
          11,
          11,
          11,
          11,
          11,
          12,
          12,
          12,
          12,
          12,
          13,
          13,
          13,
          13,
          13,
          14,
          14,
          14,
          14,
          14,
          15,
          15,
          15,
          15,
          15,
          16,
          16,
          16,
          16,
          16,
          17,
          17,
          17,
          17,
          17,
          18,
          18,
          18,
          18,
          18,
          19,
          19,
          19,
          19,
          19
        ],
        "gridcell": [
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          1,
          2,
          2,
          2,
          2,
          2,
          2,
          2,
          2,
          2,
          2,
          3,
          3,
          3,
          3,
          3,
          3,
          3,
          3,
          3,
          3,
          4,
          4,
          4,
          4,
          4,
          4,
          4,
          4,
          4,
          4,
          5,
          5,
          5,
          5,
          5,
          5,
          5,
          5,
          5,
          5,
          6,
          6,
          6,
          6,
          6,
          6,
          6,
          6,
          6,
          6,
          7,
          7,
          7,
          7,
          7,
          7,
          7,
          7,
          7,
          7,
          8,
          8,
          8,
          8,
          8,
          8,
          8,
          8,
          8,
          8,
          9,
          9,
          9,
          9,
          9,
          9,
          9,
          9,
          9,
          9
        ],
        "itype": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15,
          16,
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15,
          16,
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15,
          16,
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15,
          16,
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15,
          16,
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15,
          16,
          1,
          2,
          3,
          4
        ]
      },
      "metadata": {
        "type": "special",
        "description": "Large patch array with 100 patches across 10 gridcells and 20 columns, cycling through first 16 PFT types",
        "edge_cases": [
          "large_array"
        ],
        "expected_properties": {
          "num_patches": 100,
          "num_gridcells": 10,
          "num_columns": 20,
          "patches_per_column": 5
        }
      }
    },
    {
      "name": "test_all_crop_types",
      "inputs": {
        "begp": 0,
        "endp": 3,
        "max_patches": 10,
        "column": [
          0,
          1,
          2,
          3,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999
        ],
        "gridcell": [
          0,
          0,
          0,
          0,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999
        ],
        "itype": [
          15,
          16,
          15,
          16,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999
        ]
      },
      "metadata": {
        "type": "nominal",
        "description": "Mix of C3 crops (15) and C3 irrigated crops (16)",
        "edge_cases": [],
        "expected_properties": {
          "num_crops": 4,
          "num_irrigated": 2,
          "is_crop": true,
          "is_c3_plant": true
        }
      }
    },
    {
      "name": "test_all_shrub_types",
      "inputs": {
        "begp": 0,
        "endp": 2,
        "max_patches": 5,
        "column": [
          0,
          1,
          2,
          -9999,
          -9999
        ],
        "gridcell": [
          0,
          0,
          0,
          -9999,
          -9999
        ],
        "itype": [
          9,
          10,
          11,
          -9999,
          -9999
        ]
      },
      "metadata": {
        "type": "nominal",
        "description": "All shrub types: broadleaf evergreen (9), broadleaf deciduous temperate (10), broadleaf deciduous boreal (11)",
        "edge_cases": [],
        "expected_properties": {
          "num_patches": 3,
          "is_shrub": true,
          "num_evergreen": 1,
          "num_deciduous": 2
        }
      }
    },
    {
      "name": "test_sparse_patch_distribution",
      "inputs": {
        "begp": 10,
        "endp": 14,
        "max_patches": 20,
        "column": [
          -9999,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999,
          5,
          6,
          7,
          8,
          9,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999
        ],
        "gridcell": [
          -9999,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999,
          2,
          2,
          3,
          3,
          4,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999
        ],
        "itype": [
          -9999,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999,
          1,
          4,
          12,
          13,
          14,
          -9999,
          -9999,
          -9999,
          -9999,
          -9999
        ]
      },
      "metadata": {
        "type": "special",
        "description": "Patches starting at index 10 (not 0) with uninitialized values before and after - tests non-zero begp",
        "edge_cases": [
          "non_zero_start",
          "sparse_distribution"
        ],
        "expected_properties": {
          "num_patches": 5,
          "begp": 10,
          "endp": 14,
          "has_uninitialized_before": true,
          "has_uninitialized_after": true
        }
      }
    },
    {
      "name": "test_c3_vs_c4_photosynthesis",
      "inputs": {
        "begp": 0,
        "endp": 5,
        "max_patches": 10,
        "column": [
          0,
          0,
          1,
          1,
          2,
          2,
          -9999,
          -9999,
          -9999,
          -9999
        ],
        "gridcell": [
          0,
          0,
          0,
          0,
          0,
          0,
          -9999,
          -9999,
          -9999,
          -9999
        ],
        "itype": [
          12,
          13,
          14,
          15,
          16,
          1,
          -9999,
          -9999,
          -9999,
          -9999
        ]
      },
      "metadata": {
        "type": "nominal",
        "description": "Mix of C3 plants (arctic grass 12, non-arctic grass 13, crops 15-16, tree 1) and C4 plants (grass 14)",
        "edge_cases": [],
        "expected_properties": {
          "num_c3": 5,
          "num_c4": 1,
          "num_patches": 6,
          "has_both_photosynthesis_types": true
        }
      }
    }
  ],
  "notes": "Test data generation strategy:\n\n1. **PFT Code Selection**: Used representative PFT codes from the 0-78 range covering all major vegetation categories (trees: 1-8, shrubs: 9-11, grasses: 12-14, crops: 15-16, not vegetated: 0, high codes: 76-78).\n\n2. **Array Dimensions**: All arrays within a test case have consistent dimensions matching max_patches. Uninitialized values use ispval=-9999 as specified.\n\n3. **Hierarchy Mapping**: Column and gridcell indices are logically consistent, with multiple patches per column and multiple columns per gridcell where appropriate.\n\n4. **Index Ranges**: begp and endp define the active patch range. Values outside this range are set to ispval=-9999.\n\n5. **Edge Cases Covered**:\n   - Zero/minimal configurations (single patch, index 0)\n   - Boundary values (PFT codes 0 and 78)\n   - Large arrays (100 patches)\n   - Sparse distributions (non-zero begp)\n   - Not vegetated patches (PFT 0)\n\n6. **Physical Realism**: All PFT codes are within valid range [0, 78]. Hierarchy indices are non-negative integers. The ispval constant is used consistently for uninitialized values.\n\n7. **Test Coverage**: Tests cover all major vegetation categories, photosynthesis types (C3/C4), phenology types (evergreen/deciduous), and special classifications (tree/shrub/grass/crop/irrigated).\n\n8. **Metadata**: Each test includes expected properties to validate against, enabling comprehensive assertion checking in pytest.\n\n9. **Array Sizing**: max_patches varies from 1 to 100 to test different memory footprints and edge cases in array operations.\n\n10. **Assumptions**: ispval=-9999 for uninitialized integer values, arrays are 1D with shape (max_patches,), and PFT codes follow CLM5 conventions."
}