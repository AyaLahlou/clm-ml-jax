{
  "function_name": "surface_albedo_functions",
  "test_cases": [
    {
      "name": "test_create_surface_albedo_state_nominal_8color",
      "function": "create_surface_albedo_state",
      "inputs": {
        "ncolor": 8,
        "ncols": 5,
        "albsat_init": [
          [
            0.12,
            0.24
          ],
          [
            0.11,
            0.22
          ],
          [
            0.1,
            0.2
          ],
          [
            0.09,
            0.18
          ],
          [
            0.08,
            0.16
          ],
          [
            0.07,
            0.14
          ],
          [
            0.06,
            0.12
          ],
          [
            0.05,
            0.1
          ]
        ],
        "albdry_init": [
          [
            0.24,
            0.48
          ],
          [
            0.22,
            0.44
          ],
          [
            0.2,
            0.4
          ],
          [
            0.18,
            0.36
          ],
          [
            0.16,
            0.32
          ],
          [
            0.14,
            0.28
          ],
          [
            0.12,
            0.24
          ],
          [
            0.1,
            0.2
          ]
        ],
        "isoicol_init": [
          0,
          2,
          4,
          6,
          7
        ]
      },
      "metadata": {
        "type": "nominal",
        "description": "Standard 8-color soil classification with typical albedo values. Tests visible (0.05-0.24) and NIR (0.10-0.48) ranges with albdry >= albsat constraint.",
        "edge_cases": []
      }
    },
    {
      "name": "test_create_surface_albedo_state_nominal_20color",
      "function": "create_surface_albedo_state",
      "inputs": {
        "ncolor": 20,
        "ncols": 10,
        "albsat_init": [
          [
            0.12,
            0.24
          ],
          [
            0.11,
            0.22
          ],
          [
            0.1,
            0.2
          ],
          [
            0.09,
            0.18
          ],
          [
            0.08,
            0.16
          ],
          [
            0.07,
            0.14
          ],
          [
            0.06,
            0.12
          ],
          [
            0.05,
            0.1
          ],
          [
            0.13,
            0.26
          ],
          [
            0.14,
            0.28
          ],
          [
            0.15,
            0.3
          ],
          [
            0.16,
            0.32
          ],
          [
            0.17,
            0.34
          ],
          [
            0.18,
            0.36
          ],
          [
            0.19,
            0.38
          ],
          [
            0.2,
            0.4
          ],
          [
            0.11,
            0.23
          ],
          [
            0.12,
            0.25
          ],
          [
            0.13,
            0.27
          ],
          [
            0.14,
            0.29
          ]
        ],
        "albdry_init": [
          [
            0.24,
            0.48
          ],
          [
            0.22,
            0.44
          ],
          [
            0.2,
            0.4
          ],
          [
            0.18,
            0.36
          ],
          [
            0.16,
            0.32
          ],
          [
            0.14,
            0.28
          ],
          [
            0.12,
            0.24
          ],
          [
            0.1,
            0.2
          ],
          [
            0.26,
            0.52
          ],
          [
            0.28,
            0.56
          ],
          [
            0.3,
            0.6
          ],
          [
            0.32,
            0.64
          ],
          [
            0.34,
            0.68
          ],
          [
            0.36,
            0.72
          ],
          [
            0.38,
            0.76
          ],
          [
            0.4,
            0.8
          ],
          [
            0.22,
            0.46
          ],
          [
            0.24,
            0.5
          ],
          [
            0.26,
            0.54
          ],
          [
            0.28,
            0.58
          ]
        ],
        "isoicol_init": [
          0,
          1,
          5,
          9,
          10,
          14,
          15,
          18,
          19,
          12
        ]
      },
      "metadata": {
        "type": "nominal",
        "description": "Standard 20-color soil classification with diverse albedo values spanning full valid range. Tests larger color palette with varied soil types.",
        "edge_cases": []
      }
    },
    {
      "name": "test_create_surface_albedo_state_edge_minimum_albedo",
      "function": "create_surface_albedo_state",
      "inputs": {
        "ncolor": 8,
        "ncols": 3,
        "albsat_init": [
          [
            0.0,
            0.0
          ],
          [
            0.0,
            0.0
          ],
          [
            0.0,
            0.0
          ],
          [
            0.0,
            0.0
          ],
          [
            0.0,
            0.0
          ],
          [
            0.0,
            0.0
          ],
          [
            0.0,
            0.0
          ],
          [
            0.0,
            0.0
          ]
        ],
        "albdry_init": [
          [
            0.0,
            0.0
          ],
          [
            0.01,
            0.02
          ],
          [
            0.02,
            0.04
          ],
          [
            0.03,
            0.06
          ],
          [
            0.04,
            0.08
          ],
          [
            0.05,
            0.1
          ],
          [
            0.06,
            0.12
          ],
          [
            0.07,
            0.14
          ]
        ],
        "isoicol_init": [
          0,
          0,
          7
        ]
      },
      "metadata": {
        "type": "edge",
        "description": "Tests minimum albedo boundary (0.0) for perfectly absorbing surfaces. Albdry values slightly higher to maintain physical constraint.",
        "edge_cases": [
          "zero_albedo",
          "boundary"
        ]
      }
    },
    {
      "name": "test_create_surface_albedo_state_edge_maximum_albedo",
      "function": "create_surface_albedo_state",
      "inputs": {
        "ncolor": 8,
        "ncols": 4,
        "albsat_init": [
          [
            0.9,
            0.95
          ],
          [
            0.85,
            0.92
          ],
          [
            0.8,
            0.9
          ],
          [
            0.75,
            0.88
          ],
          [
            0.7,
            0.85
          ],
          [
            0.65,
            0.82
          ],
          [
            0.6,
            0.8
          ],
          [
            0.55,
            0.78
          ]
        ],
        "albdry_init": [
          [
            0.95,
            1.0
          ],
          [
            0.92,
            0.98
          ],
          [
            0.9,
            0.96
          ],
          [
            0.88,
            0.94
          ],
          [
            0.85,
            0.92
          ],
          [
            0.82,
            0.9
          ],
          [
            0.8,
            0.88
          ],
          [
            0.78,
            0.86
          ]
        ],
        "isoicol_init": [
          0,
          1,
          2,
          3
        ]
      },
      "metadata": {
        "type": "edge",
        "description": "Tests maximum albedo boundary (1.0) for highly reflective surfaces like light-colored dry soils or salt flats.",
        "edge_cases": [
          "maximum_albedo",
          "boundary"
        ]
      }
    },
    {
      "name": "test_surface_albedo_init_time_const_nominal",
      "function": "surface_albedo_init_time_const",
      "inputs": {
        "tower_isoicol": 5,
        "n_columns": 8,
        "numrad": 2,
        "ivis": 0,
        "inir": 1,
        "mxsoil_color": 20
      },
      "metadata": {
        "type": "nominal",
        "description": "Standard initialization with 20-color system, mid-range soil color class, and typical column count.",
        "edge_cases": []
      }
    },
    {
      "name": "test_surface_albedo_init_time_const_edge_single_column",
      "function": "surface_albedo_init_time_const",
      "inputs": {
        "tower_isoicol": 0,
        "n_columns": 1,
        "numrad": 2,
        "ivis": 0,
        "inir": 1,
        "mxsoil_color": 8
      },
      "metadata": {
        "type": "edge",
        "description": "Tests minimum column count (1) with 8-color system and darkest soil color (index 0).",
        "edge_cases": [
          "minimum_columns",
          "boundary"
        ]
      }
    },
    {
      "name": "test_soil_albedo_nominal_moderate_moisture",
      "function": "soil_albedo",
      "inputs": {
        "inputs": {
          "h2osoi_vol": [
            [
              0.25,
              0.3,
              0.28,
              0.26,
              0.24,
              0.22,
              0.2,
              0.18,
              0.16,
              0.14
            ],
            [
              0.2,
              0.25,
              0.23,
              0.21,
              0.19,
              0.17,
              0.15,
              0.13,
              0.11,
              0.09
            ],
            [
              0.3,
              0.35,
              0.33,
              0.31,
              0.29,
              0.27,
              0.25,
              0.23,
              0.21,
              0.19
            ],
            [
              0.15,
              0.2,
              0.18,
              0.16,
              0.14,
              0.12,
              0.1,
              0.08,
              0.06,
              0.04
            ]
          ],
          "isoicol": [
            3,
            7,
            12,
            15
          ],
          "albsat": [
            [
              0.12,
              0.24
            ],
            [
              0.11,
              0.22
            ],
            [
              0.1,
              0.2
            ],
            [
              0.09,
              0.18
            ],
            [
              0.08,
              0.16
            ],
            [
              0.07,
              0.14
            ],
            [
              0.06,
              0.12
            ],
            [
              0.05,
              0.1
            ],
            [
              0.13,
              0.26
            ],
            [
              0.14,
              0.28
            ],
            [
              0.15,
              0.3
            ],
            [
              0.16,
              0.32
            ],
            [
              0.17,
              0.34
            ],
            [
              0.18,
              0.36
            ],
            [
              0.19,
              0.38
            ],
            [
              0.2,
              0.4
            ],
            [
              0.11,
              0.23
            ],
            [
              0.12,
              0.25
            ],
            [
              0.13,
              0.27
            ],
            [
              0.14,
              0.29
            ]
          ],
          "albdry": [
            [
              0.24,
              0.48
            ],
            [
              0.22,
              0.44
            ],
            [
              0.2,
              0.4
            ],
            [
              0.18,
              0.36
            ],
            [
              0.16,
              0.32
            ],
            [
              0.14,
              0.28
            ],
            [
              0.12,
              0.24
            ],
            [
              0.1,
              0.2
            ],
            [
              0.26,
              0.52
            ],
            [
              0.28,
              0.56
            ],
            [
              0.3,
              0.6
            ],
            [
              0.32,
              0.64
            ],
            [
              0.34,
              0.68
            ],
            [
              0.36,
              0.72
            ],
            [
              0.38,
              0.76
            ],
            [
              0.4,
              0.8
            ],
            [
              0.22,
              0.46
            ],
            [
              0.24,
              0.5
            ],
            [
              0.26,
              0.54
            ],
            [
              0.28,
              0.58
            ]
          ],
          "filter_nourbanc": [
            0,
            1,
            2,
            3
          ]
        },
        "numrad": 2
      },
      "metadata": {
        "type": "nominal",
        "description": "Moderate soil moisture (15-35% volumetric) across 4 columns with 10 soil layers. Tests typical moisture gradient with depth and albedo interpolation.",
        "edge_cases": []
      }
    },
    {
      "name": "test_soil_albedo_edge_saturated_soil",
      "function": "soil_albedo",
      "inputs": {
        "inputs": {
          "h2osoi_vol": [
            [
              1.0,
              1.0,
              1.0,
              1.0,
              1.0,
              1.0,
              1.0,
              1.0,
              1.0,
              1.0
            ],
            [
              0.95,
              0.98,
              1.0,
              1.0,
              1.0,
              1.0,
              1.0,
              1.0,
              1.0,
              1.0
            ],
            [
              0.9,
              0.95,
              0.98,
              1.0,
              1.0,
              1.0,
              1.0,
              1.0,
              1.0,
              1.0
            ]
          ],
          "isoicol": [
            0,
            5,
            10
          ],
          "albsat": [
            [
              0.12,
              0.24
            ],
            [
              0.11,
              0.22
            ],
            [
              0.1,
              0.2
            ],
            [
              0.09,
              0.18
            ],
            [
              0.08,
              0.16
            ],
            [
              0.07,
              0.14
            ],
            [
              0.06,
              0.12
            ],
            [
              0.05,
              0.1
            ],
            [
              0.13,
              0.26
            ],
            [
              0.14,
              0.28
            ],
            [
              0.15,
              0.3
            ],
            [
              0.16,
              0.32
            ],
            [
              0.17,
              0.34
            ],
            [
              0.18,
              0.36
            ],
            [
              0.19,
              0.38
            ],
            [
              0.2,
              0.4
            ],
            [
              0.11,
              0.23
            ],
            [
              0.12,
              0.25
            ],
            [
              0.13,
              0.27
            ],
            [
              0.14,
              0.29
            ]
          ],
          "albdry": [
            [
              0.24,
              0.48
            ],
            [
              0.22,
              0.44
            ],
            [
              0.2,
              0.4
            ],
            [
              0.18,
              0.36
            ],
            [
              0.16,
              0.32
            ],
            [
              0.14,
              0.28
            ],
            [
              0.12,
              0.24
            ],
            [
              0.1,
              0.2
            ],
            [
              0.26,
              0.52
            ],
            [
              0.28,
              0.56
            ],
            [
              0.3,
              0.6
            ],
            [
              0.32,
              0.64
            ],
            [
              0.34,
              0.68
            ],
            [
              0.36,
              0.72
            ],
            [
              0.38,
              0.76
            ],
            [
              0.4,
              0.8
            ],
            [
              0.22,
              0.46
            ],
            [
              0.24,
              0.5
            ],
            [
              0.26,
              0.54
            ],
            [
              0.28,
              0.58
            ]
          ],
          "filter_nourbanc": [
            0,
            1,
            2
          ]
        },
        "numrad": 2
      },
      "metadata": {
        "type": "edge",
        "description": "Fully saturated soil (100% volumetric water content). Tests maximum moisture boundary where albedo should equal albsat values.",
        "edge_cases": [
          "saturated_soil",
          "maximum_moisture",
          "boundary"
        ]
      }
    },
    {
      "name": "test_soil_albedo_edge_completely_dry",
      "function": "soil_albedo",
      "inputs": {
        "inputs": {
          "h2osoi_vol": [
            [
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.01,
              0.005,
              0.002,
              0.001,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ],
            [
              0.02,
              0.01,
              0.005,
              0.002,
              0.001,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          ],
          "isoicol": [
            2,
            8,
            19
          ],
          "albsat": [
            [
              0.12,
              0.24
            ],
            [
              0.11,
              0.22
            ],
            [
              0.1,
              0.2
            ],
            [
              0.09,
              0.18
            ],
            [
              0.08,
              0.16
            ],
            [
              0.07,
              0.14
            ],
            [
              0.06,
              0.12
            ],
            [
              0.05,
              0.1
            ],
            [
              0.13,
              0.26
            ],
            [
              0.14,
              0.28
            ],
            [
              0.15,
              0.3
            ],
            [
              0.16,
              0.32
            ],
            [
              0.17,
              0.34
            ],
            [
              0.18,
              0.36
            ],
            [
              0.19,
              0.38
            ],
            [
              0.2,
              0.4
            ],
            [
              0.11,
              0.23
            ],
            [
              0.12,
              0.25
            ],
            [
              0.13,
              0.27
            ],
            [
              0.14,
              0.29
            ]
          ],
          "albdry": [
            [
              0.24,
              0.48
            ],
            [
              0.22,
              0.44
            ],
            [
              0.2,
              0.4
            ],
            [
              0.18,
              0.36
            ],
            [
              0.16,
              0.32
            ],
            [
              0.14,
              0.28
            ],
            [
              0.12,
              0.24
            ],
            [
              0.1,
              0.2
            ],
            [
              0.26,
              0.52
            ],
            [
              0.28,
              0.56
            ],
            [
              0.3,
              0.6
            ],
            [
              0.32,
              0.64
            ],
            [
              0.34,
              0.68
            ],
            [
              0.36,
              0.72
            ],
            [
              0.38,
              0.76
            ],
            [
              0.4,
              0.8
            ],
            [
              0.22,
              0.46
            ],
            [
              0.24,
              0.5
            ],
            [
              0.26,
              0.54
            ],
            [
              0.28,
              0.58
            ]
          ],
          "filter_nourbanc": [
            0,
            1,
            2
          ]
        },
        "numrad": 2
      },
      "metadata": {
        "type": "edge",
        "description": "Completely dry soil (0% volumetric water content). Tests minimum moisture boundary where albedo should approach albdry + maximum moisture correction (0.11).",
        "edge_cases": [
          "dry_soil",
          "zero_moisture",
          "boundary"
        ]
      }
    },
    {
      "name": "test_soil_albedo_wrapper_nominal_mixed_conditions",
      "function": "soil_albedo_wrapper",
      "inputs": {
        "bounds": {
          "begc": 0,
          "endc": 6
        },
        "num_nourbanc": 5,
        "filter_nourbanc": [
          0,
          2,
          3,
          5,
          6
        ],
        "waterstate_inst": {
          "h2osoi_vol_col": [
            [
              0.22,
              0.25,
              0.28,
              0.3,
              0.32,
              0.34,
              0.35,
              0.36,
              0.37,
              0.38
            ],
            [
              0.18,
              0.2,
              0.22,
              0.24,
              0.26,
              0.28,
              0.3,
              0.32,
              0.34,
              0.36
            ],
            [
              0.35,
              0.38,
              0.4,
              0.42,
              0.44,
              0.45,
              0.46,
              0.47,
              0.48,
              0.49
            ],
            [
              0.1,
              0.12,
              0.14,
              0.16,
              0.18,
              0.2,
              0.22,
              0.24,
              0.26,
              0.28
            ],
            [
              0.28,
              0.3,
              0.32,
              0.34,
              0.36,
              0.38,
              0.4,
              0.42,
              0.44,
              0.46
            ],
            [
              0.15,
              0.18,
              0.2,
              0.22,
              0.24,
              0.26,
              0.28,
              0.3,
              0.32,
              0.34
            ],
            [
              0.4,
              0.42,
              0.44,
              0.46,
              0.48,
              0.5,
              0.52,
              0.54,
              0.56,
              0.58
            ]
          ]
        },
        "isoicol": [
          4,
          1,
          8,
          12,
          6,
          15,
          18
        ],
        "albsat": [
          [
            0.12,
            0.24
          ],
          [
            0.11,
            0.22
          ],
          [
            0.1,
            0.2
          ],
          [
            0.09,
            0.18
          ],
          [
            0.08,
            0.16
          ],
          [
            0.07,
            0.14
          ],
          [
            0.06,
            0.12
          ],
          [
            0.05,
            0.1
          ],
          [
            0.13,
            0.26
          ],
          [
            0.14,
            0.28
          ],
          [
            0.15,
            0.3
          ],
          [
            0.16,
            0.32
          ],
          [
            0.17,
            0.34
          ],
          [
            0.18,
            0.36
          ],
          [
            0.19,
            0.38
          ],
          [
            0.2,
            0.4
          ],
          [
            0.11,
            0.23
          ],
          [
            0.12,
            0.25
          ],
          [
            0.13,
            0.27
          ],
          [
            0.14,
            0.29
          ]
        ],
        "albdry": [
          [
            0.24,
            0.48
          ],
          [
            0.22,
            0.44
          ],
          [
            0.2,
            0.4
          ],
          [
            0.18,
            0.36
          ],
          [
            0.16,
            0.32
          ],
          [
            0.14,
            0.28
          ],
          [
            0.12,
            0.24
          ],
          [
            0.1,
            0.2
          ],
          [
            0.26,
            0.52
          ],
          [
            0.28,
            0.56
          ],
          [
            0.3,
            0.6
          ],
          [
            0.32,
            0.64
          ],
          [
            0.34,
            0.68
          ],
          [
            0.36,
            0.72
          ],
          [
            0.38,
            0.76
          ],
          [
            0.4,
            0.8
          ],
          [
            0.22,
            0.46
          ],
          [
            0.24,
            0.5
          ],
          [
            0.26,
            0.54
          ],
          [
            0.28,
            0.58
          ]
        ],
        "numrad": 2
      },
      "metadata": {
        "type": "nominal",
        "description": "Mixed moisture conditions across 7 columns with 5 non-urban points. Tests realistic spatial heterogeneity with moisture ranging from dry (10%) to moist (58%).",
        "edge_cases": []
      }
    }
  ],
  "notes": "Test data generation strategy:\n\n1. **Albedo Values**: Generated following physical constraints where albdry >= albsat and NIR >= VIS. Typical soil albedo ranges: VIS (0.05-0.40), NIR (0.10-0.80). Darker soils have lower indices, lighter soils higher.\n\n2. **Soil Moisture**: Volumetric water content (0.0-1.0 m\u00b3/m\u00b3) with realistic depth gradients. Typical ranges: dry (0-0.15), moderate (0.15-0.35), moist (0.35-0.60), saturated (>0.90).\n\n3. **Soil Color Classes**: Distributed across valid ranges (0-7 for 8-color, 0-19 for 20-color) representing different soil types from dark organic-rich to light sandy/calcareous.\n\n4. **Array Dimensions**: \n   - nlevgrnd = 10 (standard soil layer count)\n   - numrad = 2 (visible and NIR wavebands)\n   - ncols varies (1-10) to test different spatial scales\n\n5. **Edge Cases**: Include boundary conditions (0.0, 1.0 for albedo and moisture), minimum array sizes (1 column), and extreme but valid physical states (fully saturated, completely dry).\n\n6. **Physical Realism**: \n   - Moisture correction formula: inc = max(0.11 - 0.40*h2osoi_vol, 0.0)\n   - Albedo interpolation between wet and dry states based on top layer moisture\n   - NIR albedo typically 1.5-2.5x visible albedo for soils\n   - Depth gradients show increasing moisture with depth (typical)\n\n7. **Filter Arrays**: Non-urban column filters use valid indices within bounds, testing partial domain coverage.\n\nAll test cases maintain dimensional consistency and physical constraints within each scenario."
}