{
  "function_name": "pftconMod",
  "test_cases": [
    {
      "name": "test_nominal_temperate_forest_pfts",
      "inputs": {
        "pft_indices": [
          1,
          2,
          3,
          4,
          5
        ],
        "mxpft": 78,
        "numrad": 2,
        "dleaf": [
          0.04,
          0.04,
          0.04,
          0.04,
          0.04
        ],
        "c3psn": [
          1.0,
          1.0,
          1.0,
          1.0,
          1.0
        ],
        "xl": [
          0.01,
          0.01,
          0.01,
          0.01,
          0.01
        ],
        "rhol": [
          [
            0.07,
            0.35
          ],
          [
            0.08,
            0.36
          ],
          [
            0.08,
            0.36
          ],
          [
            0.1,
            0.45
          ],
          [
            0.1,
            0.45
          ]
        ],
        "rhos": [
          [
            0.16,
            0.39
          ],
          [
            0.16,
            0.39
          ],
          [
            0.16,
            0.39
          ],
          [
            0.16,
            0.39
          ],
          [
            0.16,
            0.39
          ]
        ],
        "taul": [
          [
            0.05,
            0.1
          ],
          [
            0.05,
            0.1
          ],
          [
            0.05,
            0.1
          ],
          [
            0.05,
            0.25
          ],
          [
            0.05,
            0.25
          ]
        ],
        "taus": [
          [
            0.001,
            0.001
          ],
          [
            0.001,
            0.001
          ],
          [
            0.001,
            0.001
          ],
          [
            0.001,
            0.001
          ],
          [
            0.001,
            0.001
          ]
        ],
        "roota_par": [
          7.0,
          7.0,
          7.0,
          6.0,
          6.0
        ],
        "rootb_par": [
          2.0,
          2.0,
          2.0,
          2.0,
          2.0
        ],
        "rootprof_beta": [
          0.943,
          0.943,
          0.943,
          0.966,
          0.966
        ],
        "slatop": [
          0.012,
          0.012,
          0.012,
          0.01,
          0.01
        ],
        "vcmaxpft": [
          62.5,
          62.5,
          62.5,
          41.0,
          41.0
        ],
        "gplant_SPA": [
          40.0,
          40.0,
          40.0,
          35.0,
          35.0
        ],
        "capac_SPA": [
          2000.0,
          2000.0,
          2000.0,
          1800.0,
          1800.0
        ],
        "iota_SPA": [
          4000.0,
          4000.0,
          4000.0,
          3500.0,
          3500.0
        ],
        "root_radius_SPA": [
          0.00029,
          0.00029,
          0.00029,
          0.00029,
          0.00029
        ],
        "root_density_SPA": [
          310000.0,
          310000.0,
          310000.0,
          310000.0,
          310000.0
        ],
        "root_resist_SPA": [
          25.0,
          25.0,
          25.0,
          25.0,
          25.0
        ],
        "gsmin_SPA": [
          0.002,
          0.002,
          0.002,
          0.002,
          0.002
        ],
        "g0_BB": [
          0.01,
          0.01,
          0.01,
          0.01,
          0.01
        ],
        "g1_BB": [
          9.0,
          9.0,
          9.0,
          9.0,
          9.0
        ],
        "g0_MED": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g1_MED": [
          4.7,
          4.7,
          4.7,
          4.7,
          4.7
        ],
        "psi50_gs": [
          -2.5,
          -2.5,
          -2.5,
          -2.0,
          -2.0
        ],
        "shape_gs": [
          3.0,
          3.0,
          3.0,
          3.0,
          3.0
        ],
        "emleaf": [
          0.97,
          0.97,
          0.97,
          0.97,
          0.97
        ],
        "clump_fac": [
          0.75,
          0.75,
          0.75,
          0.8,
          0.8
        ],
        "pbeta_lai": [
          1.0,
          1.0,
          1.0,
          1.0,
          1.0
        ],
        "qbeta_lai": [
          1.0,
          1.0,
          1.0,
          1.0,
          1.0
        ],
        "pbeta_sai": [
          1.0,
          1.0,
          1.0,
          1.0,
          1.0
        ],
        "qbeta_sai": [
          1.0,
          1.0,
          1.0,
          1.0,
          1.0
        ]
      },
      "metadata": {
        "type": "nominal",
        "description": "Typical temperate forest PFTs (needleleaf evergreen and deciduous trees) with realistic parameter values",
        "edge_cases": []
      }
    },
    {
      "name": "test_nominal_c4_grassland_pfts",
      "inputs": {
        "pft_indices": [
          13,
          14
        ],
        "mxpft": 78,
        "numrad": 2,
        "dleaf": [
          0.04,
          0.04
        ],
        "c3psn": [
          0.0,
          0.0
        ],
        "xl": [
          -0.3,
          -0.3
        ],
        "rhol": [
          [
            0.11,
            0.35
          ],
          [
            0.11,
            0.35
          ]
        ],
        "rhos": [
          [
            0.36,
            0.58
          ],
          [
            0.36,
            0.58
          ]
        ],
        "taul": [
          [
            0.05,
            0.34
          ],
          [
            0.05,
            0.34
          ]
        ],
        "taus": [
          [
            0.22,
            0.38
          ],
          [
            0.22,
            0.38
          ]
        ],
        "roota_par": [
          6.0,
          6.0
        ],
        "rootb_par": [
          2.0,
          2.0
        ],
        "rootprof_beta": [
          0.943,
          0.943
        ],
        "slatop": [
          0.02,
          0.02
        ],
        "vcmaxpft": [
          39.0,
          39.0
        ],
        "gplant_SPA": [
          50.0,
          50.0
        ],
        "capac_SPA": [
          1500.0,
          1500.0
        ],
        "iota_SPA": [
          1800.0,
          1800.0
        ],
        "root_radius_SPA": [
          0.00029,
          0.00029
        ],
        "root_density_SPA": [
          310000.0,
          310000.0
        ],
        "root_resist_SPA": [
          25.0,
          25.0
        ],
        "gsmin_SPA": [
          0.002,
          0.002
        ],
        "g0_BB": [
          0.04,
          0.04
        ],
        "g1_BB": [
          4.0,
          4.0
        ],
        "g0_MED": [
          0.0,
          0.0
        ],
        "g1_MED": [
          1.6,
          1.6
        ],
        "psi50_gs": [
          -3.0,
          -3.0
        ],
        "shape_gs": [
          4.0,
          4.0
        ],
        "emleaf": [
          0.97,
          0.97
        ],
        "clump_fac": [
          0.85,
          0.85
        ],
        "pbeta_lai": [
          1.0,
          1.0
        ],
        "qbeta_lai": [
          1.0,
          1.0
        ],
        "pbeta_sai": [
          1.0,
          1.0
        ],
        "qbeta_sai": [
          1.0,
          1.0
        ]
      },
      "metadata": {
        "type": "nominal",
        "description": "C4 grassland PFTs with characteristic C4 photosynthesis pathway (c3psn=0.0) and appropriate water use efficiency",
        "edge_cases": []
      }
    },
    {
      "name": "test_edge_minimum_valid_values",
      "inputs": {
        "pft_indices": [
          0,
          1,
          2
        ],
        "mxpft": 78,
        "numrad": 2,
        "dleaf": [
          0.001,
          0.001,
          0.001
        ],
        "c3psn": [
          1.0,
          0.0,
          1.0
        ],
        "xl": [
          -1.0,
          -1.0,
          -1.0
        ],
        "rhol": [
          [
            0.0,
            0.0
          ],
          [
            0.0,
            0.0
          ],
          [
            0.0,
            0.0
          ]
        ],
        "rhos": [
          [
            0.0,
            0.0
          ],
          [
            0.0,
            0.0
          ],
          [
            0.0,
            0.0
          ]
        ],
        "taul": [
          [
            0.0,
            0.0
          ],
          [
            0.0,
            0.0
          ],
          [
            0.0,
            0.0
          ]
        ],
        "taus": [
          [
            0.0,
            0.0
          ],
          [
            0.0,
            0.0
          ],
          [
            0.0,
            0.0
          ]
        ],
        "roota_par": [
          0.1,
          0.1,
          0.1
        ],
        "rootb_par": [
          0.1,
          0.1,
          0.1
        ],
        "rootprof_beta": [
          0.0,
          0.0,
          0.0
        ],
        "slatop": [
          0.001,
          0.001,
          0.001
        ],
        "vcmaxpft": [
          1.0,
          1.0,
          1.0
        ],
        "gplant_SPA": [
          0.1,
          0.1,
          0.1
        ],
        "capac_SPA": [
          10.0,
          10.0,
          10.0
        ],
        "iota_SPA": [
          100.0,
          100.0,
          100.0
        ],
        "root_radius_SPA": [
          1e-06,
          1e-06,
          1e-06
        ],
        "root_density_SPA": [
          1000.0,
          1000.0,
          1000.0
        ],
        "root_resist_SPA": [
          0.1,
          0.1,
          0.1
        ],
        "gsmin_SPA": [
          1e-06,
          1e-06,
          1e-06
        ],
        "g0_BB": [
          0.0,
          0.0,
          0.0
        ],
        "g1_BB": [
          0.1,
          0.1,
          0.1
        ],
        "g0_MED": [
          0.0,
          0.0,
          0.0
        ],
        "g1_MED": [
          0.1,
          0.1,
          0.1
        ],
        "psi50_gs": [
          -10.0,
          -10.0,
          -10.0
        ],
        "shape_gs": [
          0.1,
          0.1,
          0.1
        ],
        "emleaf": [
          0.0,
          0.0,
          0.0
        ],
        "clump_fac": [
          0.0,
          0.0,
          0.0
        ],
        "pbeta_lai": [
          0.1,
          0.1,
          0.1
        ],
        "qbeta_lai": [
          0.1,
          0.1,
          0.1
        ],
        "pbeta_sai": [
          0.1,
          0.1,
          0.1
        ],
        "qbeta_sai": [
          0.1,
          0.1,
          0.1
        ]
      },
      "metadata": {
        "type": "edge",
        "description": "Tests minimum valid values at lower bounds of constraints (zeros and near-zeros)",
        "edge_cases": [
          "zero_reflectance",
          "zero_transmittance",
          "minimum_conductance",
          "minimum_leaf_dimension"
        ]
      }
    },
    {
      "name": "test_edge_maximum_valid_values",
      "inputs": {
        "pft_indices": [
          75,
          76,
          77,
          78
        ],
        "mxpft": 78,
        "numrad": 2,
        "dleaf": [
          0.5,
          0.5,
          0.5,
          0.5
        ],
        "c3psn": [
          1.0,
          1.0,
          1.0,
          1.0
        ],
        "xl": [
          1.0,
          1.0,
          1.0,
          1.0
        ],
        "rhol": [
          [
            1.0,
            1.0
          ],
          [
            1.0,
            1.0
          ],
          [
            1.0,
            1.0
          ],
          [
            1.0,
            1.0
          ]
        ],
        "rhos": [
          [
            1.0,
            1.0
          ],
          [
            1.0,
            1.0
          ],
          [
            1.0,
            1.0
          ],
          [
            1.0,
            1.0
          ]
        ],
        "taul": [
          [
            1.0,
            1.0
          ],
          [
            1.0,
            1.0
          ],
          [
            1.0,
            1.0
          ],
          [
            1.0,
            1.0
          ]
        ],
        "taus": [
          [
            1.0,
            1.0
          ],
          [
            1.0,
            1.0
          ],
          [
            1.0,
            1.0
          ],
          [
            1.0,
            1.0
          ]
        ],
        "roota_par": [
          50.0,
          50.0,
          50.0,
          50.0
        ],
        "rootb_par": [
          10.0,
          10.0,
          10.0,
          10.0
        ],
        "rootprof_beta": [
          1.0,
          1.0,
          1.0,
          1.0
        ],
        "slatop": [
          0.1,
          0.1,
          0.1,
          0.1
        ],
        "vcmaxpft": [
          200.0,
          200.0,
          200.0,
          200.0
        ],
        "gplant_SPA": [
          500.0,
          500.0,
          500.0,
          500.0
        ],
        "capac_SPA": [
          10000.0,
          10000.0,
          10000.0,
          10000.0
        ],
        "iota_SPA": [
          10000.0,
          10000.0,
          10000.0,
          10000.0
        ],
        "root_radius_SPA": [
          0.01,
          0.01,
          0.01,
          0.01
        ],
        "root_density_SPA": [
          10000000.0,
          10000000.0,
          10000000.0,
          10000000.0
        ],
        "root_resist_SPA": [
          100.0,
          100.0,
          100.0,
          100.0
        ],
        "gsmin_SPA": [
          0.1,
          0.1,
          0.1,
          0.1
        ],
        "g0_BB": [
          0.5,
          0.5,
          0.5,
          0.5
        ],
        "g1_BB": [
          20.0,
          20.0,
          20.0,
          20.0
        ],
        "g0_MED": [
          0.5,
          0.5,
          0.5,
          0.5
        ],
        "g1_MED": [
          15.0,
          15.0,
          15.0,
          15.0
        ],
        "psi50_gs": [
          -0.1,
          -0.1,
          -0.1,
          -0.1
        ],
        "shape_gs": [
          10.0,
          10.0,
          10.0,
          10.0
        ],
        "emleaf": [
          1.0,
          1.0,
          1.0,
          1.0
        ],
        "clump_fac": [
          1.0,
          1.0,
          1.0,
          1.0
        ],
        "pbeta_lai": [
          10.0,
          10.0,
          10.0,
          10.0
        ],
        "qbeta_lai": [
          10.0,
          10.0,
          10.0,
          10.0
        ],
        "pbeta_sai": [
          10.0,
          10.0,
          10.0,
          10.0
        ],
        "qbeta_sai": [
          10.0,
          10.0,
          10.0,
          10.0
        ]
      },
      "metadata": {
        "type": "edge",
        "description": "Tests maximum valid values at upper bounds of constraints (perfect reflectance/transmittance, high PFT indices)",
        "edge_cases": [
          "maximum_reflectance",
          "maximum_transmittance",
          "maximum_pft_index",
          "high_vcmax"
        ]
      }
    },
    {
      "name": "test_edge_negative_water_potential",
      "inputs": {
        "pft_indices": [
          10,
          11,
          12
        ],
        "mxpft": 78,
        "numrad": 2,
        "dleaf": [
          0.04,
          0.04,
          0.04
        ],
        "c3psn": [
          1.0,
          1.0,
          1.0
        ],
        "xl": [
          0.1,
          0.1,
          0.1
        ],
        "rhol": [
          [
            0.1,
            0.4
          ],
          [
            0.1,
            0.4
          ],
          [
            0.1,
            0.4
          ]
        ],
        "rhos": [
          [
            0.2,
            0.4
          ],
          [
            0.2,
            0.4
          ],
          [
            0.2,
            0.4
          ]
        ],
        "taul": [
          [
            0.05,
            0.2
          ],
          [
            0.05,
            0.2
          ],
          [
            0.05,
            0.2
          ]
        ],
        "taus": [
          [
            0.001,
            0.001
          ],
          [
            0.001,
            0.001
          ],
          [
            0.001,
            0.001
          ]
        ],
        "roota_par": [
          7.0,
          7.0,
          7.0
        ],
        "rootb_par": [
          2.0,
          2.0,
          2.0
        ],
        "rootprof_beta": [
          0.95,
          0.95,
          0.95
        ],
        "slatop": [
          0.015,
          0.015,
          0.015
        ],
        "vcmaxpft": [
          50.0,
          50.0,
          50.0
        ],
        "gplant_SPA": [
          30.0,
          30.0,
          30.0
        ],
        "capac_SPA": [
          1500.0,
          1500.0,
          1500.0
        ],
        "iota_SPA": [
          3000.0,
          3000.0,
          3000.0
        ],
        "root_radius_SPA": [
          0.00029,
          0.00029,
          0.00029
        ],
        "root_density_SPA": [
          310000.0,
          310000.0,
          310000.0
        ],
        "root_resist_SPA": [
          25.0,
          25.0,
          25.0
        ],
        "gsmin_SPA": [
          0.002,
          0.002,
          0.002
        ],
        "g0_BB": [
          0.01,
          0.01,
          0.01
        ],
        "g1_BB": [
          8.0,
          8.0,
          8.0
        ],
        "g0_MED": [
          0.0,
          0.0,
          0.0
        ],
        "g1_MED": [
          4.0,
          4.0,
          4.0
        ],
        "psi50_gs": [
          -8.0,
          -6.5,
          -5.0
        ],
        "shape_gs": [
          5.0,
          4.5,
          4.0
        ],
        "emleaf": [
          0.97,
          0.97,
          0.97
        ],
        "clump_fac": [
          0.7,
          0.7,
          0.7
        ],
        "pbeta_lai": [
          1.0,
          1.0,
          1.0
        ],
        "qbeta_lai": [
          1.0,
          1.0,
          1.0
        ],
        "pbeta_sai": [
          1.0,
          1.0,
          1.0
        ],
        "qbeta_sai": [
          1.0,
          1.0,
          1.0
        ]
      },
      "metadata": {
        "type": "edge",
        "description": "Tests drought-adapted PFTs with very negative water potentials (psi50_gs constraint: max=0)",
        "edge_cases": [
          "extreme_negative_water_potential",
          "drought_adaptation"
        ]
      }
    },
    {
      "name": "test_special_single_pft",
      "inputs": {
        "pft_indices": [
          0
        ],
        "mxpft": 78,
        "numrad": 2,
        "dleaf": [
          0.04
        ],
        "c3psn": [
          -999.0
        ],
        "xl": [
          0.0
        ],
        "rhol": [
          [
            0.0,
            0.0
          ]
        ],
        "rhos": [
          [
            0.0,
            0.0
          ]
        ],
        "taul": [
          [
            0.0,
            0.0
          ]
        ],
        "taus": [
          [
            0.0,
            0.0
          ]
        ],
        "roota_par": [
          0.0
        ],
        "rootb_par": [
          0.0
        ],
        "rootprof_beta": [
          0.0
        ],
        "slatop": [
          0.0
        ],
        "vcmaxpft": [
          0.0
        ],
        "gplant_SPA": [
          0.0
        ],
        "capac_SPA": [
          0.0
        ],
        "iota_SPA": [
          0.0
        ],
        "root_radius_SPA": [
          0.0
        ],
        "root_density_SPA": [
          0.0
        ],
        "root_resist_SPA": [
          0.0
        ],
        "gsmin_SPA": [
          0.0
        ],
        "g0_BB": [
          0.0
        ],
        "g1_BB": [
          0.0
        ],
        "g0_MED": [
          0.0
        ],
        "g1_MED": [
          0.0
        ],
        "psi50_gs": [
          0.0
        ],
        "shape_gs": [
          0.0
        ],
        "emleaf": [
          0.0
        ],
        "clump_fac": [
          0.0
        ],
        "pbeta_lai": [
          0.0
        ],
        "qbeta_lai": [
          0.0
        ],
        "pbeta_sai": [
          0.0
        ],
        "qbeta_sai": [
          0.0
        ]
      },
      "metadata": {
        "type": "special",
        "description": "Tests bare ground PFT (index 0) with special value -999.0 for c3psn and zeros for all parameters",
        "edge_cases": [
          "bare_ground",
          "special_value_c3psn"
        ]
      }
    },
    {
      "name": "test_special_mixed_c3_c4_pathways",
      "inputs": {
        "pft_indices": [
          6,
          7,
          8,
          13,
          14,
          15
        ],
        "mxpft": 78,
        "numrad": 2,
        "dleaf": [
          0.04,
          0.04,
          0.04,
          0.04,
          0.04,
          0.04
        ],
        "c3psn": [
          1.0,
          1.0,
          1.0,
          0.0,
          0.0,
          0.0
        ],
        "xl": [
          0.25,
          0.25,
          0.25,
          -0.3,
          -0.3,
          -0.3
        ],
        "rhol": [
          [
            0.1,
            0.45
          ],
          [
            0.1,
            0.45
          ],
          [
            0.1,
            0.45
          ],
          [
            0.11,
            0.35
          ],
          [
            0.11,
            0.35
          ],
          [
            0.11,
            0.35
          ]
        ],
        "rhos": [
          [
            0.16,
            0.39
          ],
          [
            0.16,
            0.39
          ],
          [
            0.16,
            0.39
          ],
          [
            0.36,
            0.58
          ],
          [
            0.36,
            0.58
          ],
          [
            0.36,
            0.58
          ]
        ],
        "taul": [
          [
            0.05,
            0.25
          ],
          [
            0.05,
            0.25
          ],
          [
            0.05,
            0.25
          ],
          [
            0.05,
            0.34
          ],
          [
            0.05,
            0.34
          ],
          [
            0.05,
            0.34
          ]
        ],
        "taus": [
          [
            0.001,
            0.001
          ],
          [
            0.001,
            0.001
          ],
          [
            0.001,
            0.001
          ],
          [
            0.22,
            0.38
          ],
          [
            0.22,
            0.38
          ],
          [
            0.22,
            0.38
          ]
        ],
        "roota_par": [
          6.0,
          6.0,
          6.0,
          6.0,
          6.0,
          6.0
        ],
        "rootb_par": [
          2.0,
          2.0,
          2.0,
          2.0,
          2.0,
          2.0
        ],
        "rootprof_beta": [
          0.966,
          0.966,
          0.966,
          0.943,
          0.943,
          0.943
        ],
        "slatop": [
          0.01,
          0.01,
          0.01,
          0.02,
          0.02,
          0.02
        ],
        "vcmaxpft": [
          41.0,
          41.0,
          41.0,
          39.0,
          39.0,
          39.0
        ],
        "gplant_SPA": [
          35.0,
          35.0,
          35.0,
          50.0,
          50.0,
          50.0
        ],
        "capac_SPA": [
          1800.0,
          1800.0,
          1800.0,
          1500.0,
          1500.0,
          1500.0
        ],
        "iota_SPA": [
          3500.0,
          3500.0,
          3500.0,
          1800.0,
          1800.0,
          1800.0
        ],
        "root_radius_SPA": [
          0.00029,
          0.00029,
          0.00029,
          0.00029,
          0.00029,
          0.00029
        ],
        "root_density_SPA": [
          310000.0,
          310000.0,
          310000.0,
          310000.0,
          310000.0,
          310000.0
        ],
        "root_resist_SPA": [
          25.0,
          25.0,
          25.0,
          25.0,
          25.0,
          25.0
        ],
        "gsmin_SPA": [
          0.002,
          0.002,
          0.002,
          0.002,
          0.002,
          0.002
        ],
        "g0_BB": [
          0.01,
          0.01,
          0.01,
          0.04,
          0.04,
          0.04
        ],
        "g1_BB": [
          9.0,
          9.0,
          9.0,
          4.0,
          4.0,
          4.0
        ],
        "g0_MED": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g1_MED": [
          4.7,
          4.7,
          4.7,
          1.6,
          1.6,
          1.6
        ],
        "psi50_gs": [
          -2.0,
          -2.0,
          -2.0,
          -3.0,
          -3.0,
          -3.0
        ],
        "shape_gs": [
          3.0,
          3.0,
          3.0,
          4.0,
          4.0,
          4.0
        ],
        "emleaf": [
          0.97,
          0.97,
          0.97,
          0.97,
          0.97,
          0.97
        ],
        "clump_fac": [
          0.8,
          0.8,
          0.8,
          0.85,
          0.85,
          0.85
        ],
        "pbeta_lai": [
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0
        ],
        "qbeta_lai": [
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0
        ],
        "pbeta_sai": [
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0
        ],
        "qbeta_sai": [
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0
        ]
      },
      "metadata": {
        "type": "special",
        "description": "Tests mixed C3 and C4 PFTs in same dataset to verify photosynthetic pathway handling",
        "edge_cases": [
          "mixed_photosynthetic_pathways"
        ]
      }
    },
    {
      "name": "test_special_high_lai_tropical_forest",
      "inputs": {
        "pft_indices": [
          8,
          9,
          10
        ],
        "mxpft": 78,
        "numrad": 2,
        "dleaf": [
          0.04,
          0.04,
          0.04
        ],
        "c3psn": [
          1.0,
          1.0,
          1.0
        ],
        "xl": [
          0.1,
          0.1,
          0.1
        ],
        "rhol": [
          [
            0.1,
            0.45
          ],
          [
            0.1,
            0.45
          ],
          [
            0.1,
            0.45
          ]
        ],
        "rhos": [
          [
            0.16,
            0.39
          ],
          [
            0.16,
            0.39
          ],
          [
            0.16,
            0.39
          ]
        ],
        "taul": [
          [
            0.05,
            0.25
          ],
          [
            0.05,
            0.25
          ],
          [
            0.05,
            0.25
          ]
        ],
        "taus": [
          [
            0.001,
            0.001
          ],
          [
            0.001,
            0.001
          ],
          [
            0.001,
            0.001
          ]
        ],
        "roota_par": [
          10.0,
          10.0,
          10.0
        ],
        "rootb_par": [
          3.0,
          3.0,
          3.0
        ],
        "rootprof_beta": [
          0.98,
          0.98,
          0.98
        ],
        "slatop": [
          0.03,
          0.03,
          0.03
        ],
        "vcmaxpft": [
          85.0,
          85.0,
          85.0
        ],
        "gplant_SPA": [
          80.0,
          80.0,
          80.0
        ],
        "capac_SPA": [
          3000.0,
          3000.0,
          3000.0
        ],
        "iota_SPA": [
          5000.0,
          5000.0,
          5000.0
        ],
        "root_radius_SPA": [
          0.00029,
          0.00029,
          0.00029
        ],
        "root_density_SPA": [
          310000.0,
          310000.0,
          310000.0
        ],
        "root_resist_SPA": [
          25.0,
          25.0,
          25.0
        ],
        "gsmin_SPA": [
          0.002,
          0.002,
          0.002
        ],
        "g0_BB": [
          0.01,
          0.01,
          0.01
        ],
        "g1_BB": [
          9.0,
          9.0,
          9.0
        ],
        "g0_MED": [
          0.0,
          0.0,
          0.0
        ],
        "g1_MED": [
          4.7,
          4.7,
          4.7
        ],
        "psi50_gs": [
          -1.5,
          -1.5,
          -1.5
        ],
        "shape_gs": [
          2.5,
          2.5,
          2.5
        ],
        "emleaf": [
          0.97,
          0.97,
          0.97
        ],
        "clump_fac": [
          0.6,
          0.6,
          0.6
        ],
        "pbeta_lai": [
          2.0,
          2.0,
          2.0
        ],
        "qbeta_lai": [
          2.0,
          2.0,
          2.0
        ],
        "pbeta_sai": [
          1.5,
          1.5,
          1.5
        ],
        "qbeta_sai": [
          1.5,
          1.5,
          1.5
        ]
      },
      "metadata": {
        "type": "special",
        "description": "Tests tropical broadleaf evergreen forest with high LAI, high Vcmax, and high hydraulic conductance",
        "edge_cases": [
          "high_productivity",
          "tropical_conditions"
        ]
      }
    },
    {
      "name": "test_nominal_arctic_tundra_pfts",
      "inputs": {
        "pft_indices": [
          16,
          17,
          18
        ],
        "mxpft": 78,
        "numrad": 2,
        "dleaf": [
          0.04,
          0.04,
          0.04
        ],
        "c3psn": [
          1.0,
          1.0,
          1.0
        ],
        "xl": [
          0.01,
          0.01,
          0.01
        ],
        "rhol": [
          [
            0.11,
            0.35
          ],
          [
            0.11,
            0.35
          ],
          [
            0.11,
            0.35
          ]
        ],
        "rhos": [
          [
            0.36,
            0.58
          ],
          [
            0.36,
            0.58
          ],
          [
            0.36,
            0.58
          ]
        ],
        "taul": [
          [
            0.05,
            0.34
          ],
          [
            0.05,
            0.34
          ],
          [
            0.05,
            0.34
          ]
        ],
        "taus": [
          [
            0.22,
            0.38
          ],
          [
            0.22,
            0.38
          ],
          [
            0.22,
            0.38
          ]
        ],
        "roota_par": [
          11.0,
          11.0,
          11.0
        ],
        "rootb_par": [
          2.0,
          2.0,
          2.0
        ],
        "rootprof_beta": [
          0.914,
          0.914,
          0.914
        ],
        "slatop": [
          0.025,
          0.025,
          0.025
        ],
        "vcmaxpft": [
          25.0,
          25.0,
          25.0
        ],
        "gplant_SPA": [
          20.0,
          20.0,
          20.0
        ],
        "capac_SPA": [
          1000.0,
          1000.0,
          1000.0
        ],
        "iota_SPA": [
          2500.0,
          2500.0,
          2500.0
        ],
        "root_radius_SPA": [
          0.00029,
          0.00029,
          0.00029
        ],
        "root_density_SPA": [
          310000.0,
          310000.0,
          310000.0
        ],
        "root_resist_SPA": [
          25.0,
          25.0,
          25.0
        ],
        "gsmin_SPA": [
          0.002,
          0.002,
          0.002
        ],
        "g0_BB": [
          0.01,
          0.01,
          0.01
        ],
        "g1_BB": [
          9.0,
          9.0,
          9.0
        ],
        "g0_MED": [
          0.0,
          0.0,
          0.0
        ],
        "g1_MED": [
          2.2,
          2.2,
          2.2
        ],
        "psi50_gs": [
          -2.5,
          -2.5,
          -2.5
        ],
        "shape_gs": [
          3.0,
          3.0,
          3.0
        ],
        "emleaf": [
          0.97,
          0.97,
          0.97
        ],
        "clump_fac": [
          0.9,
          0.9,
          0.9
        ],
        "pbeta_lai": [
          1.0,
          1.0,
          1.0
        ],
        "qbeta_lai": [
          1.0,
          1.0,
          1.0
        ],
        "pbeta_sai": [
          1.0,
          1.0,
          1.0
        ],
        "qbeta_sai": [
          1.0,
          1.0,
          1.0
        ]
      },
      "metadata": {
        "type": "nominal",
        "description": "Arctic tundra PFTs with low Vcmax, shallow rooting, and cold-adapted characteristics",
        "edge_cases": []
      }
    },
    {
      "name": "test_edge_contrasting_optical_properties",
      "inputs": {
        "pft_indices": [
          20,
          21,
          22,
          23
        ],
        "mxpft": 78,
        "numrad": 2,
        "dleaf": [
          0.04,
          0.04,
          0.04,
          0.04
        ],
        "c3psn": [
          1.0,
          1.0,
          1.0,
          1.0
        ],
        "xl": [
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "rhol": [
          [
            0.05,
            0.3
          ],
          [
            0.15,
            0.5
          ],
          [
            0.07,
            0.35
          ],
          [
            0.12,
            0.45
          ]
        ],
        "rhos": [
          [
            0.1,
            0.3
          ],
          [
            0.25,
            0.5
          ],
          [
            0.16,
            0.39
          ],
          [
            0.2,
            0.45
          ]
        ],
        "taul": [
          [
            0.02,
            0.05
          ],
          [
            0.1,
            0.4
          ],
          [
            0.05,
            0.1
          ],
          [
            0.08,
            0.3
          ]
        ],
        "taus": [
          [
            0.001,
            0.001
          ],
          [
            0.1,
            0.2
          ],
          [
            0.001,
            0.001
          ],
          [
            0.05,
            0.1
          ]
        ],
        "roota_par": [
          7.0,
          7.0,
          7.0,
          7.0
        ],
        "rootb_par": [
          2.0,
          2.0,
          2.0,
          2.0
        ],
        "rootprof_beta": [
          0.95,
          0.95,
          0.95,
          0.95
        ],
        "slatop": [
          0.015,
          0.015,
          0.015,
          0.015
        ],
        "vcmaxpft": [
          50.0,
          50.0,
          50.0,
          50.0
        ],
        "gplant_SPA": [
          40.0,
          40.0,
          40.0,
          40.0
        ],
        "capac_SPA": [
          2000.0,
          2000.0,
          2000.0,
          2000.0
        ],
        "iota_SPA": [
          4000.0,
          4000.0,
          4000.0,
          4000.0
        ],
        "root_radius_SPA": [
          0.00029,
          0.00029,
          0.00029,
          0.00029
        ],
        "root_density_SPA": [
          310000.0,
          310000.0,
          310000.0,
          310000.0
        ],
        "root_resist_SPA": [
          25.0,
          25.0,
          25.0,
          25.0
        ],
        "gsmin_SPA": [
          0.002,
          0.002,
          0.002,
          0.002
        ],
        "g0_BB": [
          0.01,
          0.01,
          0.01,
          0.01
        ],
        "g1_BB": [
          9.0,
          9.0,
          9.0,
          9.0
        ],
        "g0_MED": [
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g1_MED": [
          4.7,
          4.7,
          4.7,
          4.7
        ],
        "psi50_gs": [
          -2.5,
          -2.5,
          -2.5,
          -2.5
        ],
        "shape_gs": [
          3.0,
          3.0,
          3.0,
          3.0
        ],
        "emleaf": [
          0.95,
          0.98,
          0.96,
          0.97
        ],
        "clump_fac": [
          0.7,
          0.85,
          0.75,
          0.8
        ],
        "pbeta_lai": [
          1.0,
          1.0,
          1.0,
          1.0
        ],
        "qbeta_lai": [
          1.0,
          1.0,
          1.0,
          1.0
        ],
        "pbeta_sai": [
          1.0,
          1.0,
          1.0,
          1.0
        ],
        "qbeta_sai": [
          1.0,
          1.0,
          1.0,
          1.0
        ]
      },
      "metadata": {
        "type": "edge",
        "description": "Tests PFTs with contrasting optical properties (reflectance/transmittance) across visible and NIR bands",
        "edge_cases": [
          "contrasting_vis_nir",
          "variable_optical_properties"
        ]
      }
    }
  ],
  "notes": "Test data generation strategy:\n\n1. **Nominal cases (50%)**: Generated realistic PFT parameter values based on typical vegetation types:\n   - Temperate forests (needleleaf evergreen/deciduous)\n   - C4 grasslands with appropriate photosynthetic pathway\n   - Arctic tundra with cold-adapted characteristics\n   - Tropical forests with high productivity parameters\n\n2. **Edge cases (30%)**: Tested boundary conditions:\n   - Minimum valid values (zeros, near-zeros) for all constrained parameters\n   - Maximum valid values (1.0 for fractions, high indices, perfect reflectance)\n   - Extreme negative water potentials for drought-adapted species\n   - Contrasting optical properties across radiation bands\n\n3. **Special cases (20%)**: Tested unique scenarios:\n   - Bare ground (PFT index 0) with special -999.0 value for c3psn\n   - Mixed C3/C4 pathways in single dataset\n   - High LAI tropical conditions\n\n**Physical realism ensured**:\n- All positive-constrained values >= 0\n- Fractions (reflectance, transmittance, emissivity, clumping) in [0, 1]\n- Water potentials (psi50_gs) <= 0 (negative pressure)\n- PFT indices in valid range [0, 78]\n- Photosynthetic pathway values: 0.0 (C4), 1.0 (C3), or -999.0 (bare ground)\n- Array dimensions consistent: (mxpft+1,) for 1D, (mxpft+1, numrad) for 2D\n- Radiation bands: 0=visible, 1=near-infrared\n\n**Parameter relationships maintained**:\n- C4 plants have lower g1 values (water use efficiency)\n- Tropical forests have higher Vcmax, hydraulic conductance\n- Arctic tundra has lower Vcmax, shallower roots\n- Optical properties vary realistically between VIS and NIR bands"
}