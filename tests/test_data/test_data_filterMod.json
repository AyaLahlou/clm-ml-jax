{
  "function_name": "filterMod",
  "test_cases": [
    {
      "name": "test_allocFilters_small_grid",
      "inputs": {
        "begp": 1,
        "endp": 10,
        "begc": 1,
        "endc": 5
      },
      "metadata": {
        "type": "nominal",
        "description": "Tests basic allocation with small grid (10 patches, 5 columns)",
        "edge_cases": []
      }
    },
    {
      "name": "test_allocFilters_single_element",
      "inputs": {
        "begp": 1,
        "endp": 1,
        "begc": 1,
        "endc": 1
      },
      "metadata": {
        "type": "edge",
        "description": "Tests minimum valid grid size (single patch and column)",
        "edge_cases": [
          "minimum_size"
        ]
      }
    },
    {
      "name": "test_allocFilters_large_grid",
      "inputs": {
        "begp": 1,
        "endp": 10000,
        "begc": 1,
        "endc": 5000
      },
      "metadata": {
        "type": "special",
        "description": "Tests allocation with large realistic grid (10k patches, 5k columns)",
        "edge_cases": []
      }
    },
    {
      "name": "test_setExposedvegpFilter_mixed_coverage",
      "inputs": {
        "nolakeurban_indices": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10
        ],
        "frac_veg_nosno": [
          0.0,
          0.1,
          0.25,
          0.5,
          0.75,
          0.9,
          1.0,
          0.0,
          0.001,
          0.999
        ],
        "max_patches": 10
      },
      "metadata": {
        "type": "nominal",
        "description": "Tests exposed vegetation filter with mixed coverage values including zeros, small values, and full coverage",
        "edge_cases": [
          "zero_coverage",
          "full_coverage",
          "near_zero",
          "near_one"
        ]
      }
    },
    {
      "name": "test_setExposedvegpFilter_all_zero",
      "inputs": {
        "nolakeurban_indices": [
          1,
          2,
          3,
          4,
          5
        ],
        "frac_veg_nosno": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "max_patches": 5
      },
      "metadata": {
        "type": "edge",
        "description": "Tests filter when all patches have zero vegetation coverage (should result in empty filter)",
        "edge_cases": [
          "all_zero"
        ]
      }
    },
    {
      "name": "test_setExposedvegpFilter_all_exposed",
      "inputs": {
        "nolakeurban_indices": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8
        ],
        "frac_veg_nosno": [
          1.0,
          0.95,
          0.88,
          0.76,
          0.65,
          0.54,
          0.43,
          0.32
        ],
        "max_patches": 8
      },
      "metadata": {
        "type": "nominal",
        "description": "Tests filter when all patches have non-zero vegetation (all should be included)",
        "edge_cases": []
      }
    },
    {
      "name": "test_setExposedvegpFilter_sparse_coverage",
      "inputs": {
        "nolakeurban_indices": [
          1,
          5,
          10,
          15,
          20,
          25,
          30,
          35,
          40,
          45,
          50
        ],
        "frac_veg_nosno": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.3,
          0.0,
          0.0,
          0.0,
          0.0,
          0.6,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "max_patches": 50
      },
      "metadata": {
        "type": "special",
        "description": "Tests filter with sparse non-contiguous indices and mostly zero coverage",
        "edge_cases": [
          "sparse_indices"
        ]
      }
    },
    {
      "name": "test_create_filter_instance_typical",
      "inputs": {
        "begp": 1,
        "endp": 100,
        "begc": 1,
        "endc": 50
      },
      "metadata": {
        "type": "nominal",
        "description": "Tests factory function with typical grid dimensions (100 patches, 50 columns)",
        "edge_cases": []
      }
    },
    {
      "name": "test_apply_patch_filter_multidimensional",
      "inputs": {
        "data": [
          [
            1.0,
            2.0,
            3.0
          ],
          [
            4.0,
            5.0,
            6.0
          ],
          [
            7.0,
            8.0,
            9.0
          ],
          [
            10.0,
            11.0,
            12.0
          ],
          [
            13.0,
            14.0,
            15.0
          ],
          [
            16.0,
            17.0,
            18.0
          ],
          [
            19.0,
            20.0,
            21.0
          ],
          [
            22.0,
            23.0,
            24.0
          ]
        ],
        "filter_indices": [
          1,
          3,
          5,
          7
        ],
        "num_filtered": 4
      },
      "metadata": {
        "type": "nominal",
        "description": "Tests applying patch filter to 2D data array (8 patches x 3 features)",
        "edge_cases": []
      }
    },
    {
      "name": "test_get_filter_indices_boundary",
      "inputs": {
        "filter_name": "exposedvegp",
        "exposedvegp_array": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "num_exposedvegp": 15,
        "begp": 1,
        "endp": 15
      },
      "metadata": {
        "type": "edge",
        "description": "Tests retrieving filter indices when filter is at maximum capacity (all patches included)",
        "edge_cases": [
          "full_filter"
        ]
      }
    }
  ],
  "notes": "Test data generation assumptions:\n\n1. **Index conventions**: All indices are 1-based following Fortran conventions. Valid patch/column indices start at 1.\n\n2. **Physical constraints**: \n   - frac_veg_nosno values are constrained to [0.0, 1.0] representing fractions\n   - Zero values represent no vegetation or complete snow coverage\n   - Values near 1.0 represent nearly complete vegetation exposure\n\n3. **Array dimensions**:\n   - Patch counts (begp to endp) typically range from 1 to 10,000 for realistic grids\n   - Column counts (begc to endc) are typically 50-70% of patch counts\n   - Filter arrays are sized to max_patches to allow for dynamic filtering\n\n4. **Edge cases covered**:\n   - Minimum grid size (1x1)\n   - Empty filters (all zeros)\n   - Full filters (all non-zero)\n   - Sparse/non-contiguous indices\n   - Boundary values (0.0, 1.0, near-zero, near-one)\n   - Large realistic grids (10k patches)\n\n5. **Filter semantics**:\n   - exposedvegp: patches with frac_veg_nosno > 0\n   - nolakeurbanp: pre-filtered patches excluding lakes and urban areas\n   - Filters use 1-based indexing and are compacted (valid indices at beginning)\n\n6. **JAX compatibility**:\n   - All arrays use int32 for indices (JAX default)\n   - Float arrays use float32/float64 as appropriate\n   - Test data avoids NaN/Inf unless specifically testing error handling\n\n7. **Test coverage strategy**:\n   - 50% nominal: typical operating conditions with realistic values\n   - 30% edge: boundary conditions, zeros, extremes\n   - 20% special: unusual but valid scenarios (sparse data, large grids, multidimensional)\n\n8. **Multidimensional data**: Some tests include 2D arrays to verify filter operations work correctly with additional feature dimensions beyond the patch/column axis."
}